var name,ws=new WebSocket("wss://"+location.host+"/groupcall"),participants={},pcounter=0,i_am_guest=0,registered=0,guru_is_here=0,rejoined=0,problems=0,altlang=["en","ru","es","fr","cn","pt"],waiting=1,waiting_period=633e3,logo_added=0,firstTime=!0,he_votado=!1,playSomeMusic=!1,shareSomeScreen=!1,already_being_played=!1,now_playing=!1,audio=null,audience_number=0,just_left="",connection_is_good=1,new_message=0,acc_id=getCookie("acc")||"";const ua=navigator.userAgent.toLowerCase(),isAndroid=ua.indexOf("android")>-1,isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),small_device=!!((check_iOS()||isAndroid)&&screen.width<=1024),fps=15,wi=640,fps_hq=24,wi_hq=1280,role=0;function rejoin(){rejoined++,problems?(leaveRoom(),register()):function(){0===pcounter&&registered&&(soundEffect.src="/sounds/drop.mp3",$("phones").innerHTML=sorry,$("phones").fade(1),setTimeout((function(){location.reload()}),1e3))}.delay(1e3)}function check_connection(){connection_is_good=0;sendMessage({id:"checkConnection"}),setTimeout((function(){connection_is_good||(console.log("resetting connection"),leaveRoom(),register())}),1200)}function check_fullscreen(){fullscreen&&(!acc_id||window.screenTop||window.screenY||(window.innerWidth!=screen.width||window.innerHeight!=screen.height)&&isAndroid)&&(fullscreen=!1,acc_id?fullscreen=!0:(leaveRoom(),register()))}function signalGuru(e){e.preventDefault(),e.stopPropagation();sendMessage({id:"signalGuru"})}function leftHandler(e){fetch("https://"+window.location.hostname+":8453/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((t=>{let n=t||0;e.preventDefault(),e.stopPropagation();let o=parseInt($("leftnum").innerHTML)+1;$("leftnum").innerHTML=o.toString(),sendMessage({id:"plus",s:"l",num:o}),1!=n&&(setCookie("vote",1,144e3),he_votado=!0,$("leftplus").removeEventListener("click",leftHandler),$("rightplus").removeEventListener("click",rightHandler))})).catch((e=>console.log(e)))}function rightHandler(e){fetch("https://"+window.location.hostname+":8453/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((t=>{let n=t||0;e.preventDefault(),e.stopPropagation();let o=parseInt($("rightnum").innerHTML)+1;$("rightnum").innerHTML=o.toString(),sendMessage({id:"plus",s:"r",num:o}),he_votado=!0,1!=n&&(setCookie("vote",1,144e3),he_votado=!0,$("leftplus").removeEventListener("click",leftHandler),$("rightplus").removeEventListener("click",rightHandler))})).catch((e=>console.log(e)))}function register(){getCookie("av")&&guru_is_here&&(aonly=0);let e=screen.width>1023?"7":"";aonly?($("av_toggler")&&($("av_toggler").style.background="url(/icons/vcall"+e+"2.png) center center no-repeat"),$("bcam").style.background="url(/icons/switch"+e+"2.png) center center no-repeat",$("fcam").style.background="url(/icons/webcam"+e+"2.png) center center no-repeat"):$("av_toggler")&&($("av_toggler").style.background="url(/icons/vcall"+e+"2.png) center center no-repeat #f78f3f"),ws.readyState===WebSocket.CLOSED?(problems=1,(ws=new WebSocket("wss://"+location.host+"/groupcall")).onmessage=function(e){var t=JSON.parse(e.data);switch(t.id){case"existingParticipants":onExistingParticipants(t);break;case"existingViewers":onExistingViewers(t);break;case"newParticipantArrived":fullscreen||onNewParticipant(t);break;case"newViewerArrived":onNewViewer(t);break;case"participantLeft":onParticipantLeft(t);break;case"receiveVideoAnswer":receiveVideoResponse(t);break;case"changeTab":changeTabLR(t);break;case"clearCoo":clearTimeoutAndLeave();break;case"setGuru":setGuru(t);break;case"askGuru":askGuru(t);break;case"setCinema":setCinema(t);break;case"goodConnection":connection_is_good=1;break;case"newChatMessage":newChatMessage();break;case"viewerLeft":let e=(just_left=t.name).split("_"),n=e[e.length-1];if($("_au_"+n)){$("_au_"+n).dispose();let e="..."==$("audience_numbers").innerHTML?0:parseInt($("audience_numbers").innerHTML)-1;e=e>0?e:"...",$("audience_numbers").innerHTML=e;let t=e>0?"#369":"#ccc";$("audience_numbers").setStyles({color:t}),$("audience_boxx").innerHTML="..."==e?"Audience is empty :(":$("audience_boxx").innerHTML,"..."==e&&(chat_shown=1,$("logger").click(),$("audience").click())}break;case"iceCandidate":participants[t.name].rtcPeer.addIceCandidate(t.candidate,(function(e){e&&console.error("Error adding candidate: "+e)}));break;default:console.error("Unrecognized message",t)}},$("phones").innerHTML=warning,$("phones").style.lineHeight="28px"):problems=0,name=$("name").value;var t=loadData("name");name.length||(name=t),name.length&&"null"!==name||saveData("name",name=(name=makeid(8))+"_"+name,1440);var n=window.location.hostname.split("."),o=""==$("roomName").value?n[0]:$("roomName").value,i=$("curip").value;registered=1,fetch("https://"+window.location.hostname+":8453/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((e=>{let t=e||0;if(temporary&&0==t&&(t=3),-1==t)return soundEffect.src="/sounds/lock.mp3",setTimeout((function(){location.reload()}),1200),console.log("Knock out2"),!1;$("room-header").innerText="ROOM "+o,$("room-header").style.display="block",$("room-backer").style.display="none",$("join").style.display="none",$("room").style.display="block",$("preroom").innerHTML="&nbsp;",$("postroom").style.display="none",$("house").style.minHeight="0px",$("house").style.background="transparent",$("phones").style.display="block",$("phones").style.visibility="visible",$("cr").style.display="none",$("av_selector").style.display="block",$("poll").style.display="block",function(){$("phones").style.paddingTop=small_device&&0==t?"24vh":0!=t?"20vh":$("phones").style.paddingTop}.delay(1e3);var n=getCookie("all_muted")||!1;let r=screen.width>1023?"7":"";$("all_muter").style.background=n?"url(/icons/no_sound"+r+"2.png) center center no-repeat #f78f3f":"url(/icons/sound"+r+"2.png) center center no-repeat",$("all_muter").title=n?"Turn on sound":"Turn off all sound",$("leftplus").style.display="block",$("rightplus").style.display="block",1!=t&&he_votado||!firstTime||($("leftplus").addEventListener("click",leftHandler),$("rightplus").addEventListener("click",rightHandler),firstTime=!1),$("fmode_selector").style.display="block";var a=aonly?"a":"v";let s=getCookie("authtoken")||"";sendMessage({id:"joinRoom",name:name,mode:a,room:o,curip:i,acc_id:acc_id,token:s,role:t}),problems&&($("phones").innerHTML=warning,$("phones").fade(1)),function(){problems||$("phones").fade(0)}.delay(2e3),small_device&&!scrolled&&0==t&&(function(){new Fx.Scroll(window,{wait:!1,duration:2500}).toBottom().chain((function(){this.toTop.delay(1e3,this)}))}.delay(3e3),scrolled=!0)})).catch((e=>console.log(e)))}function onNewViewer(e){$("name").value;fetch("https://"+window.location.hostname+":8453/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((t=>{let n=e.name.split("_"),o=n[0],i=n[n.length-1],r=e.name,a=e.curip;$("_au_"+i)&&$("_au_"+i).dispose();let s="Audience is empty :("==$("audience_boxx").innerHTML?"":$("audience_boxx").innerHTML;s="<div id=_au_"+i+"><span id=au_"+i+' style="color:#9cf;cursor:pointer;" onclick="set_guru(1,\''+r+"');\">"+o+"</span>, "+a+"</div>"+s,$("audience_boxx").innerHTML=s;let c=s.split("_au_").length-1;$("audience_numbers").innerHTML=c;let l=c>0?"#369":"#ccc";$("audience_numbers").setStyles({color:l}),just_left!=r&&$("name").value!=r&&$("name").value!=just_left&&(soundEffect.src="/sounds/steps.mp3")})).catch((e=>console.log(e)))}function onNewParticipant(e){fetch("https://"+window.location.hostname+":8453/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((t=>{let n=t||0;for(var o=document.cookie.split(";"),i=1,r=0,a=1;a<=o.length;a++){if(o[a-1].match(e.name+"_hidden")){r=1,i=0;break}if(!r){var s=localStorage.getItem(e.name+"_muted");if(o[a-1].match(e.name+"_muted")||null!==s&&"null"!==s){i=0;break}}}if(i&&(soundEffect.src="/sounds/coin.mp3"),!r&&(receiveVideo(e.name,e.mode,n,!0),e.curip.length&&$("loco_"+e.name)&&!ValidateIPaddress(e.curip)&&($("loco_"+e.name).innerHTML=e.curip,$("loco_"+e.name).style.display="block",$("loco_"+e.name).fade(1)),$("acco_"+e.name)&&ValidateAccountId(e.acc_id))){$("acco_"+e.name).style.display="block";let t=e.name.split("_");$("acco_"+e.name).fade(1),$("acco_"+e.name).onclick=function(){copy(e.acc_id),$("acco_"+e.name).fade(.2),$("phones").innerHTML="copied "+t[0],$("phones").fade(1),function(){$("acco_"+e.name).innerHTML="",$("acco_"+e.name).fade(1),$("phones").fade(0)}.delay(1e3)},$("sp_container")&&"block"!=$("sp_container").style.display&&($("acco_"+e.name).style.visibility="hidden")}small_device||(4==pcounter?($("room").style.minWidth="960px",$("room").style.marginLeft="-225px"):3==pcounter?($("room").style.minWidth="690px",$("room").style.marginLeft="-84px"):pcounter<3?($("room").style.minWidth="480px",$("room").style.marginLeft="0px"):pcounter>4&&($("room").style.minWidth="1240px",$("room").style.marginLeft="-390px"))})).catch((e=>console.log(e)))}function receiveVideoResponse(e){participants[e.name].rtcPeer.processAnswer(e.sdpAnswer,(function(e){if(e)return console.error(e)}))}function callResponse(e){"accepted"!=e.response?(console.info("Call not accepted by peer. Closing call"),stop()):webRtcPeer.processAnswer(e.sdpAnswer,(function(e){if(e)return console.error(e)}))}async function startCapture(e){let t=null;try{t=await navigator.mediaDevices.getDisplayMedia(e)}catch(e){console.error("Error: "+e)}return t}function onExistingViewers(e){var t=$("name").value,n="",o=t!=just_left;if(e.data){for(var i=e.data.sort(),r=0;r<i.length;r++){var a=i[r].split("_|_");let e=a[0],c=a[1];e==just_left&&(just_left="",o=!1);let l=e.split("_"),d=l[0],u=l[l.length-1];if(e==t){o=!1;var s=getCookie("lang");if(c.length&&(null===s||"null"===s)){let e=/, AR$/.test(c),t=/, BR$/.test(c),n=/, RU$/.test(c);e?ctr=2:t?ctr=5:n&&(ctr=1),change_lang(altlang[ctr])}}n=n+"<div id=_au_"+u+"><span id=au_"+u+' style="color:#9cf;cursor:pointer;" onclick="set_guru(1,\''+e+"');\">"+d+"</span>, "+c+"</div>"}0==i.length?(n="Audience is empty :(",$("audience_numbers").setStyles({color:"#ccc"}),$("audience_numbers").innerHTML="...",audience_number=0):($("audience_numbers").setStyles({color:"#369"}),$("audience_numbers").innerHTML=i.length,i.length>audience_number&&i.length>0&&o&&(soundEffect.src="/sounds/steps.mp3"),audience_number=i.length),$("audience_boxx")&&($("audience_boxx").innerHTML=n)}}function set_guru(e,t){fetch("https://"+window.location.hostname+":8453/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((n=>{if(1==(n||0)){let n=getCookie("authtoken")||"";sendMessage({id:"setGuru",name:t,mode:e,token:n})}else $("name").value==t&&(chat_shown=1,$("logger").click(),$("audience").click(),leaveRoom(),register())})).catch((e=>console.log(e)))}function onExistingParticipants(e){fetch("https://"+window.location.hostname+":8453/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((t=>{let n=t||0;if(temporary&&0==n&&(n=3),role_zero_has_square||1==n||2==n||3==n){var o=getCookie("fmode")?"environment":"user",i=$("name").value,r=loadData(i+"_muted");var a=new Participant(name,i,aonly?"a":"v",n,!1);participants[name]=a;var s=a.getVideoElement(),c={audio:!0,video:{maxWidth:1280,maxFrameRate:24,minFrameRate:24,facingMode:o}},l={audio:!1,video:{facingMode:o}},d={audio:!0,video:!1};aonly&&(c=d),!0!==r&&"true"!==r||(c=l);var u={localVideo:s,mediaConstraints:c,onicecandidate:a.onIceCandidate.bind(a)},p={localVideo:s,mediaConstraints:!0===r||"true"===r?l:d,onicecandidate:a.onIceCandidate.bind(a)};!shareSomeScreen||1!=n&&2!=n?!playSomeMusic||1!=n&&2!=n?a.rtcPeer=new kurentoUtils.WebRtcPeer.WebRtcPeerSendonly(u,(function(e){if(e){var t=new RegExp("closed","ig");return e.toString().match(t)||(a.rtcPeer=new kurentoUtils.WebRtcPeer.WebRtcPeerSendonly(p,(function(e){if(e)return console.error(e);startVideo(s),this.generateOffer(a.offerToReceiveVideo.bind(a)),small_device&&($(i).style.float="none"),$(i).className=PARTICIPANT_MAIN_CLASS}))),!1}startVideo(s),this.generateOffer(a.offerToReceiveVideo.bind(a)),small_device&&($(i).style.float="none"),$(i).className=PARTICIPANT_MAIN_CLASS,function(){$("phones").fade(0),$("phones").style.lineHeight="50vh"}.delay(1e3)})):(s.autoplay=!0,s.playsInline=!0,s.controls=!0,s.crossOrigin="anonymous",s.volume=1,s.loop=!0,s.src=selectedFile||"/a.mp4",s.muted=!1,s.addEventListener("canplay",(e=>{if(now_playing=!0,!already_being_played){already_being_played=!0;let e=null;s.captureStream?e=s.captureStream(24):s.mozCaptureStream?e=s.mozCaptureStream(24):console.error("Stream capture is not supported");var t={audio:!0,video:{maxWidth:1280,maxFrameRate:24,minFrameRate:24}};u={videoStream:e,onicecandidate:a.onIceCandidate.bind(a),mediaConstraints:t},option_alt={videoStream:e,onicecandidate:a.onIceCandidate.bind(a),mediaConstraints:{audio:!0,video:!1}},a.rtcPeer=new kurentoUtils.WebRtcPeer.WebRtcPeerSendonly(u,(function(e){if(e){var t=new RegExp("closed","ig");return e.toString().match(t)||(a.rtcPeer=new kurentoUtils.WebRtcPeer.WebRtcPeerSendonly(p,(function(e){if(e)return console.error(e);startVideo(s),this.generateOffer(a.offerToReceiveVideo.bind(a)),small_device&&($(i).style.float="none"),$(i).className=PARTICIPANT_MAIN_CLASS,$("room-header-file").style.display="none"}))),!1}startVideo(s),this.generateOffer(a.offerToReceiveVideo.bind(a)),small_device&&($(i).style.float="none"),$(i).className=PARTICIPANT_MAIN_CLASS,$("room-header-file").style.display="none",function(){$("phones").fade(0),$("phones").style.lineHeight="50vh"}.delay(1e3)}))}}))):(shareSomeScreen=!0,$("room-header").style.color=oldColor,startCapture({video:!0}).then((e=>{navigator.mediaDevices.getUserMedia({audio:!0}).then((function(t){var n=t.getAudioTracks()[0]?t.getAudioTracks()[0]:null;n&&!0!==r&&"true"!==r&&e.addTrack(n),s.srcObject=e;var o={videoStream:e,onicecandidate:a.onIceCandidate.bind(a),mediaConstraints:{audio:!0,video:{maxWidth:1280,maxFrameRate:24,minFrameRate:24}},sendSource:"screen"};a.rtcPeer=new kurentoUtils.WebRtcPeer.WebRtcPeerSendonly(o,(function(e){if(e){var t=new RegExp("closed","ig");return e.toString().match(t)||(a.rtcPeer=new kurentoUtils.WebRtcPeer.WebRtcPeerSendonly(p,(function(e){if(e)return console.error(e);startVideo(s),this.generateOffer(a.offerToReceiveVideo.bind(a)),small_device&&($(i).style.float="none"),$(i).className=PARTICIPANT_MAIN_CLASS}))),!1}startVideo(s),this.generateOffer(a.offerToReceiveVideo.bind(a)),small_device&&($(i).style.float="none"),$(i).className=PARTICIPANT_MAIN_CLASS,function(){$("phones").fade(0),$("phones").style.lineHeight="50vh"}.delay(1e3)}))})).catch((function(e){console.log(e.name+": "+e.message)}))})).catch((e=>console.log(e))))}if(e.data){for(var f=0;f<e.data.length;f++){var m=e.data[f].split("_|_");let t=m[0],o=m[1],r=m[2],a=m[3],s=m[0].split("_");if(t!=i){receiveVideo(t,o,n,!1);let e=loadData(t+"_volume");$("slider_"+t).value=e,$("video-"+t).volume=e}else{var h=getCookie("lang");if(r.length&&(null===h||"null"===h)){let e=/, AR$/.test(r),t=/, BR$/.test(r),n=/, RU$/.test(r);e?ctr=2:t?ctr=5:n&&(ctr=1),change_lang(altlang[ctr])}}r.length&&$("loco_"+t)&&!ValidateIPaddress(r)&&($("loco_"+t).innerHTML=r,$("loco_"+t).style.display="block",$("loco_"+t).fade(1)),$("acco_"+t)&&ValidateAccountId(a)&&($("acco_"+t).style.display="block",$("acco_"+t).fade(1),$("acco_"+t).onclick=function(){copy(a),$("acco_"+t).fade(.2),$("phones").innerHTML="copied "+s[0],$("phones").fade(1),function(){$("acco_"+t).innerHTML="",$("acco_"+t).fade(1),$("phones").fade(0)}.delay(1e3)},$("sp_container")&&"block"!=$("sp_container").style.display&&($("acco_"+t).style.visibility="hidden"))}small_device||(4==pcounter?($("room").style.minWidth="960px",$("room").style.marginLeft="-225px"):3==pcounter?($("room").style.minWidth="690px",$("room").style.marginLeft="-84px"):pcounter<3?($("room").style.minWidth="480px",$("room").style.marginLeft="0px"):pcounter>4&&($("room").style.minWidth="1240px",$("room").style.marginLeft="-390px"))}})).catch((e=>console.log(e)))}function copy(e){var t=document.createElement("input");document.body.appendChild(t),t.value=e,t.select(),document.execCommand("copy",!1),t.remove()}function leaveRoom(){if(Object.keys(participants).length&&!problems){for(var e in participants)participants[e].dispose(),delete participants[e];pcounter=0,i_am_guest=0,registered=0}sendMessage({id:"leaveRoom"}),just_left=$("name").value}function receiveVideo(e,t,n,o){let i=!0===o;var r=new Participant(e,$("name").value,t,n,i);participants[e]=r;var a=r.getVideoElement(),s={remoteVideo:a,mediaConstraints:{audio:!0,video:!0},onicecandidate:r.onIceCandidate.bind(r)},c={remoteVideo:a,mediaConstraints:{audio:!0,video:!1},onicecandidate:r.onIceCandidate.bind(r)};s="a"===t?c:s,r.rtcPeer=new kurentoUtils.WebRtcPeer.WebRtcPeerRecvonly(s,(function(t){if(t)return console.error(t);startVideo(a),this.generateOffer(r.offerToReceiveVideo.bind(r)),small_device&&($(e).style.float="none",$(e).className=PARTICIPANT_MAIN_CLASS)}))}function setGuru(e){fetch("https://"+window.location.hostname+":8453/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((t=>{let n=t||0,o=screen.width>1023?"7":"";"1"==e.mode&&1!=n&&(temporary=1,chat_shown=1,$("logger").click(),$("audience").click(),leaveRoom(),register(),$("av_toggler").style.display="block",$("bell").style.display="none"),"0"==e.mode&&temporary&&(temporary=0,chat_shown=1,$("logger").click(),$("audience").click(),leaveRoom(),register(),cammode=0,$("fcam").style.background="url(/icons/webcam"+o+"2.png) center center no-repeat",$("bcam").style.background="url(/icons/switch"+o+"2.png) center center no-repeat",setCookie("av",!1,144e3),aonly=1,flashText_and_rejoin("AUDIO-ONLY"),$("av_toggler").style.display="none",$("bell").style.display="block")})).catch((e=>console.log(e)))}function askGuru(e){let t=e.name.split("_"),n=t[0],o=t[t.length-1];$("_au_"+o)&&$("_au_"+o).dispose();let i="Audience is empty :("==$("audience_boxx").innerHTML?"":$("audience_boxx").innerHTML;i="<div id=_au_"+o+"><span id=au_"+o+' style="color:#9cf;cursor:pointer;font-size:16px;font-weight:bold;" onclick="set_guru(1,\''+e.name+"');\">"+n+"</span> "+requ+"</div>"+i;i.split("_au_").length;$("audience_boxx").innerHTML=i,$("au_"+o).setStyles({color:"#faa"}),fetch("https://"+window.location.hostname+":8453/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((e=>{soundEffect.src="/sounds/wood_"+window.location.hostname+".mp3",chat_shown=0,voting_shown=0,$("logger").click(),$("message_box").style.display="none",$("audience_box").style.display="table"})).catch((e=>console.log(e)))}function setCinema(e){fetch("https://"+window.location.hostname+":8453/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((t=>{let n=t||0;participants[e.name].setMode(e.mode);let o=$("one-"+e.name),i=e.mode;o.style.color="c"==i?"#ff0":"#369",o.style.fontWeight="c"==i?"bold":"normal",o.style.display="c"==i||1==n?"block":"none",o.innerHTML="c"==i?"CINEMA!":"CINEMA?"})).catch((e=>console.log(e)))}function newChatMessage(){let e=0,t=screen.width>1023?"7":"",n=$("logger").style.background=="url(/icons/chat"+t+"2.png) center center no-repeat"?"url(/icons/chat"+t+"2.png) center center no-repeat #f78f3f":"url(/icons/chat"+t+"2.png) center center no-repeat;";new_message=1;let o=setInterval((function(){new_message?($("logger").style.background=e%2==0?"url(/icons/chat"+t+"2.png) center center no-repeat #90ee90":"url(/icons/chat"+t+"2.png) center center no-repeat",e++):($("logger").style.background=n,clearInterval(o))}),1e3);fetch("https://"+window.location.hostname+":8453/log.html").then((e=>e.text())).then((e=>{$("message_box").innerHTML=e})).catch((e=>console.log(e))),soundEffect.src="/sounds/buzz.mp3"}function changeTabLR(e){"l"==e.side&&$("leftnum")&&($("leftnum").innerHTML=e.num.toString()),"r"==e.side&&$("rightnum")&&($("rightnum").innerHTML=e.num.toString())}function clearTimeoutAndLeave(){eraseCookie("timeout_nc"),soundEffect.src="/sounds/drop.mp3",$("phones").innerHTML="Leaving room",$("phones").fade(1),setTimeout((function(){location.reload()}),1e3)}function onParticipantLeft(e){var t=participants[e.name];t&&(t.dispose(),delete participants[e.name],just_left=e.name,small_device||(4==pcounter?($("room").style.minWidth="960px",$("room").style.marginLeft="-225px"):3==pcounter?($("room").style.minWidth="690px",$("room").style.marginLeft="-84px"):pcounter<3?($("room").style.minWidth="480px",$("room").style.marginLeft="0px"):pcounter>4&&($("room").style.minWidth="1240px",$("room").style.marginLeft="-390px")))}function sendMessage(e){var t=JSON.stringify(e);ws.send(t)}function startVideo(e){e.play().catch((e=>{"NotAllowedError"===e.name&&console.error("[start] Browser doesn't allow playing video: "+e)}))}function setCookie(e,t,n){var o="";if(n){var i=new Date;i.setTime(i.getTime()+60*n*1e3),o="; SameSite=None; Secure; expires="+i.toUTCString()+";SameSite=None;Secure;"}document.cookie=e+"="+(t||"")+o+"; path=/"}function getCookie(e){for(var t=e+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var i=n[o];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(t))return i.substring(t.length,i.length)}return null}function eraseCookie(e){document.cookie=e+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;SameSite=None;Secure;"}function deleteSomeCookies(){for(var e=document.cookie.split(";"),t=0;t<e.length;t++){for(var n=e[t],o=n.indexOf("="),i=o>-1?n.substr(0,o):n;" "==i.charAt(0);)i=i.substring(1,i.length);var r=new RegExp("_muted","ig"),a=new RegExp("_hidden","ig");(i.match(r)||i.match(a)||!i.length)&&(document.cookie=i+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT;SameSite=None;Secure;")}}function listCookies(){for(var e=document.cookie.split(";"),t="",n=1;n<=e.length;n++)t+=n+" "+e[n-1]+"\n";return t}function check_iOS(){var e=navigator.userAgent;return!!(/iPad|iPhone|iPod/.test(e)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1)}function is_mobAndro(){var e=navigator.userAgent;return!(!/Android/.test(e)||!window.matchMedia("only screen and (max-width: 480px)").matches)}function makeid(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=n.length,i=0;i<e;i++)t+=n.charAt(Math.floor(Math.random()*o));return t}function saveData(e,t,n){"undefined"!=typeof Storage?localStorage.setItem(e,t):setCookie(e,t,n)}function loadData(e){return"undefined"!=typeof Storage?localStorage.getItem(e):getCookie(e)}function ValidateIPaddress(e){return!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)}function ValidateAccountId(e){return!(!/^[a-z0-9]+$/i.test(e)||48!=e.length)}window.onbeforeunload=function(){ws.close()},window.onload=function(){setInterval((function(){(registered&&!now_playing||problems)&&rejoin()}),3e4+1e4*Math.random()),setInterval((function(){registered&&waiting&&!now_playing&&rejoin()}),waiting_period+1e4*Math.random()),setInterval((function(){registered&&check_connection()}),2e4+1e4*Math.random()),setInterval((function(){registered&&check_fullscreen()}),1e3);var e=getCookie("lang");e=null===e||"null"===e||""===e?1:e,ctr=e,change_lang(altlang[ctr]);var t=getCookie("vote");he_votado=null===t||"null"===t?he_votado:t},ws.onmessage=function(e){var t=JSON.parse(e.data);switch(t.id){case"existingParticipants":onExistingParticipants(t);break;case"existingViewers":onExistingViewers(t);break;case"newParticipantArrived":fullscreen||onNewParticipant(t);break;case"newViewerArrived":onNewViewer(t);break;case"participantLeft":onParticipantLeft(t);break;case"receiveVideoAnswer":receiveVideoResponse(t);break;case"changeTab":changeTabLR(t);break;case"clearCoo":clearTimeoutAndLeave();break;case"setGuru":setGuru(t);break;case"askGuru":askGuru(t);break;case"setCinema":setCinema(t);break;case"goodConnection":connection_is_good=1;break;case"newChatMessage":newChatMessage();break;case"viewerLeft":let e=(just_left=t.name).split("_"),n=e[e.length-1];if($("_au_"+n)){$("_au_"+n).dispose();let e="..."==$("audience_numbers").innerHTML?0:parseInt($("audience_numbers").innerHTML)-1;e=e>0?e:"...",$("audience_numbers").innerHTML=e;let t=e>0?"#369":"#ccc";$("audience_numbers").setStyles({color:t}),$("audience_boxx").innerHTML="..."==e?"Audience is empty :(":$("audience_boxx").innerHTML,"..."==e&&(chat_shown=1,$("logger").click(),$("audience").click())}break;case"iceCandidate":participants[t.name].rtcPeer.addIceCandidate(t.candidate,(function(e){e&&console.error("Error adding candidate: "+e)}));break;default:console.error("Unrecognized message",t)}};var fullscreen=!1,doSwitchOneMode=function(e){let t=small_device?"66vh":420;mod6=new mBox.Modal({content:'<iframe id="sp_setter" name="sp_setter" src="https://cube.room-house.com:8449/#/binder/" scrolling="yes" style="border:0;min-height:450px;background:transparent;text-align:center;margin:-20px auto 0 -20px; width:320px;"></iframe>',setStyles:{content:{padding:"25px",lineHeight:24,margin:"0 auto",fontSize:18,color:"#222",height:t}},width:280,id:"m6",height:t,title:"SkyPirl account",attach:"newacc"}),$("newacc").click()};const PARTICIPANT_MAIN_CLASS=check_iOS()||isAndroid?"participant main_i":"participant main",PARTICIPANT_CLASS="participant";function Participant(e,t,n,o,i){this.name=e,this.mode=n;let r=!1;var a=new RegExp("GURU:","g");e.match(a)&&(guru_is_here=1,r=!0);let s=0;for(var c in participants)c.match(a)&&s++;if(s>0&&(guru_is_here=1),$(e)){var l=$(e);l.parentNode.removeChild(l)}var d=!1,u=getCookie("all_muted");null!==u&&"null"!==u||(u=!0);var p=loadData(e+"_muted");null!==p&&"null"!==p||(p=!0),e!=t&&(p=u);var f=loadData(e+"_volume");null!==f&&"null"!==f||(f=.5),e!=t&&(saveData(e+"_muted",p,1440),saveData(e+"_volume",f,1440));var m=loadData(t+"_muted");let h=getCookie("all_muted");null!==m&&"null"!==m||(m=!0===h||"true"===h);var g=document.createElement("div");g.className=O()?"participant":PARTICIPANT_MAIN_CLASS,i_am_guest=O()&1===pcounter?1:i_am_guest,1!=o&&(i_am_guest=1),1==o&0===pcounter&guru_is_here&&(i_am_guest=0),function(){$("phones").fade(0),function(){$("phones").innerHTML=""}.delay(100)}.delay(500),"undefined"!=typeof mod3&&null!==mod3&&(mod3.content.innerHTML=left_content.get(altlang[ctr])),"undefined"!=typeof mod4&&null!==mod4&&(mod4.content.innerHTML=right_content.get(altlang[ctr])),pcounter++,g.id=e,g.style.position="relative";var v=document.createElement("span"),y=document.createElement("div"),w=document.createElement("input"),b=document.createElement("video"),V=document.createElement("div"),_=document.createElement("div"),k=document.createElement("div");g.appendChild(b),g.appendChild(v),g.appendChild(y),g.onclick=M,g.ondblclick=P,$("participants").appendChild(g);var A=e.split("_"),C=A.slice(0,A.length-1).join("_");let x=C.length>11?C.substr(0,11)+"..":C;v.appendChild(document.createTextNode(x)),v.style.zIndex="1002",v.style.cursor="pointer",v.onclick=function(){fetch("https://"+window.location.hostname+":8453/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((t=>{1==t&&set_guru(0,e)})).catch((e=>console.log(e)))},y.addEventListener("click",(function(n){n.preventDefault(),n.stopPropagation(),e!=t?check_iOS()?(d=!1,L()):(w.style.display="block"==w.style.display?"none":"block",L()):L()})),w.addEventListener("change",(function(t){t.preventDefault(),t.stopPropagation(),f=w.value,saveData(e+"_volume",f,1440),saveData(e+"_muted",p=!(f>0),1440),b.volume=f,d=!0,isAndroid&&L()})),e!=t&&b.addEventListener("click",(function(t){var n;t.preventDefault(),t.stopPropagation(),"c"!=participants[e].getMode()?check_iOS()||isAndroid?function(e){isAndroid||M();isAndroid&&(g.className==PARTICIPANT_MAIN_CLASS&&R(e),"participant"==g.className&&M())}(t.target):R(t.target):(n=t.target,acc_id?doSwitchOneMode(n):($("phones").innerHTML=creatu,$("phones").fade(1),function(){$("phones").fade(0)}.delay(2e3)))})),_.onclick=function(){fetch("https://"+window.location.hostname+":8453/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((t=>{if(1==t){let t="c"==participants[e].getMode()?"v":"c",n=getCookie("authtoken")||"";sendMessage({id:"setCinema",name:e,mode:t,token:n})}})).catch((e=>console.log(e)))},k.onclick=P,y.className="speak";let T="c"==n?"#ff0":"#369";_.style.fontWeight="c"==n?"bold":"normal";let S="c"==n?"CINEMA!":"CINEMA?";_.className="onemode",_.id="one-"+e,_.style.fontSize=small_device?"18px":"14px",_.style.color=T,_.style.width=small_device?"72px":_.style.width,_.appendChild(document.createTextNode(S)),"c"!=this.mode&&1!=o&&(_.style.display="none"),1!=o&&"c"!=this.mode||(_.style.display="block"),k.className="dropper",k.id="drop-"+e,k.style.fontSize="14px",k.appendChild(document.createTextNode("X")),w.style.zIndex="1001",b.id="video-"+e,b.autoplay=!0,b.playsInline=!0,b.controls=(function(){var e=navigator.userAgent;if(/iPad/.test(e))return!0}(),!1),b.volume=f,e!=t&&(b.style.cursor="pointer"),w.type="range",w.id="slider_"+e,w.min=0,w.max=1,w.step=.1,w.style.display="none",w.style.width="90px",V.style.maxWidth="150px",V.style.position="absolute",V.style.bottom="-22px",V.style.right="0px",V.style.background="transparent",V.style.color="#9cf",V.style.zIndex="999",V.style.display="none",V.style.opacity=0,V.style.fontSize="14px",V.style.whiteSpace="nowrap",V.id="loco_"+e;var E=document.createElement("div");function M(){d?isAndroid||L():"participant"===g.className?(Array.prototype.slice.call(document.getElementsByClassName(PARTICIPANT_MAIN_CLASS)).forEach((function(e){e.className=check_iOS()||isAndroid?PARTICIPANT_MAIN_CLASS:"participant"})),g.className=PARTICIPANT_MAIN_CLASS):g.className="participant"}function R(e){e.fullscreenElement?e.exitFullscreen&&e.exitFullscreen():e.requestFullscreen()}function L(){if($("video-"+e)){var n=$("video-"+e);(!d||d&&(0===n.volume&&!n.muted||n.volume>0&&n.muted))&&(e!=t&&(n.muted=!n.muted,w.value=n.volume,d=!1,saveData(e+"_muted",n.muted,1440),saveData(e+"_volume",n.volume,1440)),y.removeChild(y.childNodes[0]),n.muted?(e!=t&&y.appendChild(document.createTextNode("🔇")),e==t&&(!0===m||"true"===m?(saveData(t+"_muted",!1,1440),m=!1,flashText_and_rejoin("microphone ON!")):(saveData(t+"_muted",!0,1440),m=!0,flashText_and_rejoin("microphone OFF!")))):y.appendChild(document.createTextNode("🔊")))}if((check_iOS()||isAndroid)&&r){y.style.fontSize="42px";let e=g.getBoundingClientRect();y.style.top=e.height-30,y.style.left=e.width-36}}function P(){if(e!=t){if(window.confirm("Drop "+C+"?!"))participants[e].dispose(),delete participants[e],pcounter--;fetch("https://"+window.location.hostname+":8453/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((t=>{if(1==t){let t=getCookie("authtoken")||"";sendMessage({id:"makeLeave",name:e,token:t})}})).catch((e=>console.log(e)))}}function O(){return 0!=document.getElementsByClassName(PARTICIPANT_MAIN_CLASS).length}E.id="acco_"+e,E.className="accos",g.appendChild(E),g.appendChild(w),g.appendChild(V),g.appendChild(_),e!=t&&g.appendChild(k),$(b.id).style.opacity=!0!==m&&"true"!==m||!aonly||e!=t?1:0,!0!==u&&"true"!==u&&!0!==p&&"true"!==p&&e!=t||(b.muted=!0),i&&(check_iOS()||isAndroid)&&r&&!0===b.muted&&function(){new Fx.Scroll(window,{wait:!1,duration:1e3}).toBottom().chain((function(){y.style.fontSize="96px";let e=g.getBoundingClientRect();y.style.top=Math.floor(e.height/2),y.style.left="30vw",y.style.top="90px",y.style.left="40vw",soundEffect.src="/sounds/guru_on.mp3"}))}.delay(1e3),!0!==b.muted?y.appendChild(document.createTextNode("🔊")):(e!=t&&y.appendChild(document.createTextNode("🔇")),e!=t||!0!==m&&"true"!==m||y.appendChild(document.createTextNode("x")),e!=t||!1!==m&&"false"!==m||y.appendChild(document.createTextNode("🎤"))),y.style.fontSize="42px",this.getVideoElement=function(){return b},this.offerToReceiveVideo=function(t,n,o){if(t)return console.error("sdp offer error");sendMessage({id:"receiveVideoFrom",sender:e,sdpOffer:n})},this.onIceCandidate=function(t,n){sendMessage({id:"onIceCandidate",candidate:t,name:e})},Object.defineProperty(this,"rtcPeer",{writable:!0}),this.dispose=function(){var t=new RegExp("GURU:","g");let n=0;for(var o in participants)o.match(t)&&n++;e.match(t)&&1==n&&(guru_is_here=0,setTimeout((function(){0}),2e3)),this.rtcPeer&&(this.rtcPeer,1)&&this.rtcPeer.dispose(),g&&g.parentNode&&g.parentNode.removeChild(g),pcounter--,0==guru_is_here&pcounter&&(i_am_guest=1),1==guru_is_here&1===pcounter&&(i_am_guest=0),n>1&&(i_am_guest=0,guru_is_here=1)},this.setMode=function(e){this.mode=e},this.getMode=function(){return this.mode}}var heads1=new Map([["en","Enter Rumhaus"],["ru","Войти в румхаус"],["es","Entrar Rumhaus"],["fr","Entrer Rumhaus"],["cn","進入 Rumhaus"],["pt","Entrar Rumhaus"]]),about=new Map([["en","about R-H"],["ru","о R-H"],["es","sobre R-H"],["fr","à propos"],["cn","關於"],["pt","sobre R-H"]]),help=new Map([["en","help"],["ru","помощь"],["es","ayuda"],["fr","aide"],["cn","幫助"],["pt","ajuda"]]),phones=new Map([["en",'..more ROOMS! <a href="https://room-house.com" target=new>here</a>'],["ru",'..больше КОМНАТ! <a href="https://room-house.com" target=new>тут</a>'],["es",'..más HABITACIONES! <a href="https://room-house.com" target=new>aquí</a>'],["fr",'..plus de CHAMBRES! <a href="https://room-house.com" target=new>ici</a>'],["cn",'..更多房间! <a href="https://room-house.com" target=new>這裡</a>'],["pt",'..mais QUARTOS! <a href="https://room-house.com" target=new>aqui</a>']]),warner=new Map([["en","RE-CONNECTING..<BR>PLEASE WAIT OR RELOAD"],["ru","соединение устанавливается..<BR>пожалуйста подождите или перегрузите окно"],["es","RECONECTANDO...<BR>ESPERE O RECARGA"],["fr","RECONNEXION..<BR>VEUILLEZ PATIENTER OU RECHARGER"],["cn","RE-CONNECTING..<BR>PLEASE WAIT OR RELOAD"],["pt","RECONECTANDO..<BR>AGUARDE OU RECARREGUE"]]),about_content=new Map([["en",'<div class="centered modal_text">Room-House is a free media network. You can setup your own Room-House node on your home computer to meet with friends, colleagues or clients in a private room: use this <a href="https://github.com/kl3eo/room-house/blob/main/xTER_VB_install.txt" target=new>how to</a> for a start; or choose an existing R-H from this <a href="https://room-house.com" target=new>big list</a>. You can write us on our <a href="https://twitter.com/RoomHouseOffic1" target=new>twitter</a>.</div>'],["ru",'<div class="centered modal_text">Room-House это свободная медиа сеть. Вы можете установить узел Room-House у себя на компьютере: см. <a href="https://github.com/kl3eo/room-house/blob/main/xTER_Room-House_Rus_v2_1_1.pdf" target=new>как</a> и используйте его для встреч с друзьями, коллегами, клиентами, и т.д. Вы можете написать нам в <a href="https://twitter.com/RoomHouseOffic1" target=new>Твиттер</a>.</div>'],["es",'<div class="centered modal_text">¿Que Debes? - registrarse como el GURU <a href=https://validate.guru target=new>aqui</a>. <br> ¿Que Puedes? - a. Mostrar su propio seleccion de videos. <br> b. Bloquear a los que molestan al publico. <br> c. Tener su propio voto del dia.<br>d. Y otras preferencias del GURU.</div>'],["fr",'<div class="centered modal_text">Room-House est un réseau média libre. Configurez votre propre Room-House sur votre ordinateur connecté à Internet: lire <a href="https://github.com/kl3eo/room-house/blob/main/xTER_VB_install.txt" target=new>comment</a> et utilisez-le pour rencontrer des amis,  collègues, clients, etc, ou choisissez un R-H de celui-ci <a href="https://room-house.com" target=new>liste</a>. Vous avez la chance de nous trouver sur notre <a href="https://twitter.com/RoomHouseOffic1" target=new>twitter</a>.</div>'],["cn",'<div class="centered modal_text">R-H 是一個免費的媒體網絡。您可以在家用電腦上設置自己的 Room-House 節點，以私密方式與朋友、同事或客戶會面: 讀 <a href="https://github.com/kl3eo/room-house/blob/main/xTER_VB_install.txt" target=new>這</a> 並用於會見朋友、同事、客戶等，或從中選擇一個工作 R-H <a href="https://room-house.com" target=new>列表t</a>. 您有幸在我們的推特上找到我們 <a href="https://twitter.com/RoomHouseOffic1" target=new>twitter</a>.</div>'],["pt",'<div class="centered modal_text">Room-House é uma rede de mídia libre. Você pode configurar sua própria Room-House em seu laptop conectado à Internet: <a href="https://github.com/kl3eo/room-house/blob/main/xTER_VB_install.txt" target=new>leia</a> para encontrar amigos, colegas, clientes, etc, ou escolha um R-H funcional desta <a href="https://room-house.com" target=new>lista</a>. Você tem a sorte de nos encontrar em nosso <a href="https://twitter.com/RoomHouseOffic1" target=new>twitter</a>.</div>']]),help_content=new Map([["en",'<div class="centered modal_text">Please, read the <a href=https://sky-pirl.gitbook.io/skypirl/room-house.com target=new>manual</a>!<br>a. Exit Chat? - Reload Window, Ctrl-R <br>b. Drop Video? - Double-click on Video\'s "name". <br>c. Mute/Unmute? - click on speaker icons.<br>d. Expand Video? - Ctrl+, use Picture in Picture, or swipe to zoom. Click on Video to possible full screen.<br>e. Any problems? - <span style="color:#009;text-decoration:underline;" onclick="var yon = window.confirm(\'OK?\');if (yon) {clearAllCookies();location.reload();};">Clear Cookies</span>.</div>'],["ru",'<div class="centered modal_text">a. Выйти? - последняя кнопка в меню. <br>b. Убрать Video? - Кликнуть на "X" справа вверху квадрата. <br>c. Убрать звук от видео или микрофона: клик по иконке "звук" справа от имени.<br>d. Увеличить Video? - клик на видео, Ctrl+, Picture in Picture, swipe.<br>e. Проблемы? - <span style="color:#009;text-decoration:underline;" onclick="var yon = window.confirm(\'OK?\');if (yon) {clearAllCookies();location.reload();};">Clear Cookies</span>.</div>'],["es",'<div class="centered modal_text">Please, read the <a href=https://sky-pirl.gitbook.io/skypirl/room-house.com target=new>manual</a>!<br>a. ¿Salir del chat? - recargar, Ctrl-R <br> b. Soltar un video? - clic en "nombre" abajo del video. <br> c. Silenciar un video/su microphono - clic en el icono bajo derecho. <br> d. ¿Expandir un video? - use Picture in Picture, o deslice para acercar.<br>e. Algun problema irresistible? - <span style="color:#009;text-decoration:underline;" onclick="var yon = window.confirm(\'OK?\');if (yon) {clearAllCookies();location.reload();};">Clear Cookies</span>.</div>'],["fr",'<div class="centered modal_text">Please, read the <a href=https://sky-pirl.gitbook.io/skypirl/room-house.com target=new>manual</a>!<br>a. Quitter le chat ? - Rechargez, Ctrl-R <br>b. Déposer la vidéo ? - Cliquez sur "name". <br>c. Désactiver le son ? - clique sur la Speaker.<br>d. Agrandir la vidéo ? - Picture in Picture, ou faites glisser pour effectuer un zoom.<br>e. Quelques problemes? - <span style="color:#009;text-decoration:underline;" onclick="var yon = window.confirm(\'OK?\');if (yon) {clearAllCookies();location.reload();};">Clear Cookies</span>.</div>'],["cn",'<div class="centered modal_text">Please, read the <a href=https://sky-pirl.gitbook.io/skypirl/room-house.com target=new>manual</a>!<br>一個。退出聊天？ - 關閉窗口，Ctrl-R <br>b。殺死壞視頻？ - 單擊名稱旁邊的“”，或雙擊/點擊視頻。 <br>c.靜音/取消靜音？ - 單擊/點擊視頻。<br>d. 展開視頻？ - 在桌面上，使用畫中畫，在移動瀏覽器上 - 滑動以放大或縮小。<br>e.任何問題？- <span style="color:#009;text-decoration:underline;" onclick="var yon = window.confirm(\'OK?\');if (yon) {clearAllCookies();location.reload();};">Clear Cookies</span>.</div>'],["pt",'<div class="centered modal_text">Please, read the <a href=https://sky-pirl.gitbook.io/skypirl/room-house.com target=new>manual</a>!<br>a. Sair? - Recarregar Ctrl-R <br> b. Soltar um vídeo? - Clique no "name" ou cliqu duas vezes no vídeo. <br> c. Desativar o som? - clique no Speaker. <br> d. Expanda o vídeo? - use Picture in Picture, ou deslize para aumentar o zoom.<br>e. Algum problem? - <span style="color:#009;text-decoration:underline;" onclick="var yon = window.confirm(\'OK?\');if (yon) {clearAllCookies();location.reload();};">Clear Cookies</span>.</div>']]),left_content=new Map([["en",'Yes, now please say "Messi!" LOUDLY in microphone to redouble your vote. Thank you for voting! You may also write some words: <input type=text id=lsender value="" onkeydown="var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : \'writeToLog\', text:this.value});mod3.close();} else {this.placeholder = \'???\';}}">'],["ru",'Да, теперь, пожалуйста, скажи "Месси!" ГРОМКО в микрофон, чтобы подтвердить свой голос. Спасибо! <input type=text id=lsender value="" onkeydown="var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : \'writeToLog\', text:this.value});mod3.close();} else {this.placeholder = \'???\';}}">'],["es",'Sí, ahora por favor di "¡Messi!" VOZ ALTA en el micrófono para redoblar su voto. Gracias por votar! Tambien puedes escribir algo: <input type=text id=lsender value="" onkeydown="var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : \'writeToLog\', text:this.value});mod3.close();} else {this.placeholder = \'???\';}}">'],["fr","Oui, maintenant, s'il vous plaît, dites 'Messi!' FORT dans le micro pour confirmer votre vote. Merci d'avoir voté! You may also write some words: <input type=text id=rsender value='' onkeydown='var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : 'writeToLog', text:this.value});mod3.close();} else {this.placeholder = '???';}}'>"],["cn",'Yes, now please say "Messi!" LOUDLY in microphone to redouble your vote. Thank you for voting! You may also write some words: <input type=text id=lsender value="" onkeydown="var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : \'writeToLog\', text:this.value});mod3.close();} else {this.placeholder = \'???\';}}">'],["pt",'Sim, agora por favor diga "Messi!" ALTO no microfone para confirmar seu voto. Obrigado por votar! You may also write some words: <input type=text id=lsender value="" onkeydown="var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : \'writeToLog\', text:this.value});mod3.close();} else {this.placeholder = \'???\';}}">']]),right_content=new Map([["en",'Yes, now please say "Ronaldo!" LOUDLY in microphone to redouble your vote. Thank you for voting! You may also write some words: <input type=text id=rsender value="" onkeydown="var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : \'writeToLog\', text:this.value});mod4.close();} else {this.placeholder = \'???\';}}">'],["ru",'Да, теперь, пожалуйста, скажи "Роналдо!" ГРОМКО в микрофон, чтобы подтвердить свой голос. Спасибо! <input type=text id=rsender value="" onkeydown="var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : \'writeToLog\', text:this.value});mod4.close();} else {this.placeholder = \'???\';}}">'],["es",'Sí, ahora por favor di "¡Ronaldo!" VOZ ALTA en el micrófono para redoblar su voto. Gracias por votar! Tambien puedes escribir algo: <input type=text id=rsender value="" onkeydown="var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : \'writeToLog\', text:this.value});mod4.close();} else {this.placeholder = \'???\';}}">'],["fr","Oui, maintenant, s'il vous plaît, dites 'Ronaldo!' FORT dans le micro pour confirmer votre vote. Merci d'avoir voté! You may also write some words: <input type=text id=rsender value='' onkeydown='var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : 'writeToLog', text:this.value});mod4.close();} else {this.placeholder = '???';}}'>"],["cn",'Yes, now please say "Ronaldo!" LOUDLY in microphone to redouble your vote. Thank you for voting! You may also write some words: <input type=text id=rsender value="" onkeydown="var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : \'writeToLog\', text:this.value});mod4.close();} else {this.placeholder = \'???\';}}">'],["pt",'Sim, agora por favor diga "Ronaldo!" ALTO no microfone para confirmar seu voto. Obrigado por votar! You may also write some words: <input type=text id=rsender value="" onkeydown="var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : \'writeToLog\', text:this.value});mod4.close();} else {this.placeholder = \'???\';}}">']]),central_content=new Map([["en","WRITE TO CHAT: <input type=text id=lsender value=\"\" onkeydown=\"var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : 'writeToLog', text:this.value.replace(/'/g, '')});mod5.close();} else {this.placeholder = '???';}}\">"],["ru","WRITE TO CHAT: <input type=text id=lsender value=\"\" onkeydown=\"var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : 'writeToLog', text:this.value.replace(/'/g, '')});mod5.close();} else {this.placeholder = '???';}}\">"],["es","WRITE TO CHAT: <input type=text id=lsender value=\"\" onkeydown=\"var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : 'writeToLog', text:this.value.replace(/'/g, '')});mod5.close();} else {this.placeholder = '???';}}\">"],["fr","WRITE TO CHAT: <input type=text id=lsender value=\"\" onkeydown=\"var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : 'writeToLog', text:this.value.replace(/'/g, '')});mod5.close();} else {this.placeholder = '???';}}\">"],["cn","WRITE TO CHAT: <input type=text id=lsender value=\"\" onkeydown=\"var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : 'writeToLog', text:this.value.replace(/'/g, '')});mod5.close();} else {this.placeholder = '???';}}\">"],["pt","WRITE TO CHAT: <input type=text id=lsender value=\"\" onkeydown=\"var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : 'writeToLog', text:this.value.replace(/'/g, '')});mod5.close();} else {this.placeholder = '???';}}\">"]]),new_account=new Map([["en","Your account ID (copy/paste and hit Enter) <input type=text id=rsender style=\"width:210px;\" value=\"\" onkeydown=\"var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length == 48 && this.value.substring(0,1) == '5') {setCookie('acc',this.value,144000);mod6.close();$('sp_balance').src='https://cube.room-house.com:8444/?acc='+this.value;leaveRoom();register();} else {this.value='';this.placeholder = 'Please enter valid address';}}\"><br>Create <a href='https://wallet.room-house.com/#/accounts/0' target='new'>a new account</a>."],["es","Your account ID (copy/paste and hit Enter) <input type=text id=rsender style=\"width:210px;\" value=\"\" onkeydown=\"var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length == 48 && this.value.substring(0,1) == '5') {setCookie('acc',this.value,144000);mod6.close();$('sp_balance').src='https://cube.room-house.com:8444/?acc='+this.value;leaveRoom();register();} else {this.value='';this.placeholder = 'Please enter valid address';}}\"><br>Create <a href='https://wallet.room-house.com/#/accounts/0' target='new'>a new account</a>."],["pt","Your account ID (copy/paste and hit Enter) <input type=text id=rsender style=\"width:210px;\" value=\"\" onkeydown=\"var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length == 48 && this.value.substring(0,1) == '5') {setCookie('acc',this.value,144000);mod6.close();$('sp_balance').src='https://cube.room-house.com:8444/?acc='+this.value;leaveRoom();register();} else {this.value='';this.placeholder = 'Please enter valid address';}}\"><br>Create <a href='https://wallet.room-house.com/#/accounts/0' target='new'>a new account</a>."],["fr","Your account ID (copy/paste and hit Enter) <input type=text id=rsender style=\"width:210px;\" value=\"\" onkeydown=\"var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length == 48 && this.value.substring(0,1) == '5') {setCookie('acc',this.value,144000);mod6.close();$('sp_balance').src='https://cube.room-house.com:8444/?acc='+this.value;leaveRoom();register();} else {this.value='';this.placeholder = 'Please enter valid address';}}\"><br>Create <a href='https://wallet.room-house.com/#/accounts/0' target='new'>a new account</a>."],["cn","Your account ID (copy/paste and hit Enter) <input type=text id=rsender style=\"width:210px;\" value=\"\" onkeydown=\"var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length == 48 && this.value.substring(0,1) == '5') {setCookie('acc',this.value,144000);mod6.close();$('sp_balance').src='https://cube.room-house.com:8444/?acc='+this.value;leaveRoom();register();} else {this.value='';this.placeholder = 'Please enter valid address';}}\"><br>Create <a href='https://wallet.room-house.com/#/accounts/0' target='new'>a new account</a>."],["ru","Your account ID (copy/paste and hit Enter) <input type=text id=rsender style=\"width:210px;\" value=\"\" onkeydown=\"var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length == 48 && this.value.substring(0,1) == '5') {setCookie('acc',this.value,144000);mod6.close();$('sp_balance').src='https://cube.room-house.com:8444/?acc='+this.value;leaveRoom();register();} else {this.value='';this.placeholder = 'Please enter valid address';}}\"><br>Create <a href='https://wallet.room-house.com/#/accounts/0' target='new'>a new account</a>."]]),left_label=new Map([["en","for MESSI:"],["ru","за Месси:"],["es","por MESSI:"],["fr","pour MESSI:"],["cn","for MESSI:"],["pt","por MESSI:"]]),right_label=new Map([["en","for RONALDO:"],["ru","за Роналдо:"],["es","por RONALDO:"],["fr","pour RONALDO:"],["cn","for RONALDO:"],["pt","por RONALDO:"]]),for_por=new Map([["en","for"],["ru","за"],["es","por"],["fr","pour"],["cn","for"],["pt","por"]]),sorry_=new Map([["en","Sorry"],["ru","Извините, никого нет."],["es","Lo siento"],["fr","Désolé"],["cn","Sorry"],["pt","Desculpe"]]),hola_=new Map([["en","Hello, guys!"],["ru","Привет, ребята!"],["es","¡Hola chicos!"],["fr","Bonjour gars!"],["cn","Hello, guys!"],["pt","Ola pessoal!"]]),waiter_=new Map([["en","..waiting.."],["ru","..ожидание.."],["es","..esperando.."],["fr","..en attente.."],["cn","..waiting.."],["pt","..esperando.."]]),caller_=new Map([["en","CALL GURU - hit "],["ru","ПОЗВОНИТЕ В "],["es","CALL GURU - hit "],["fr","CALL GURU - hit "],["cn","CALL GURU - hit "],["pt","CALL GURU - hit "]]),requ_=new Map([["en","is requesting"],["ru","в ожидании"],["es","is requesting"],["fr","is requesting"],["cn","is requesting"],["pt","is requesting"]]),creatu_=new Map([["en","CREATE or bind account!"],["ru","СОЗДАЙТЕ АККАУНТ!"],["es","CREATE or bind account!"],["fr","CREATE or bind account!"],["cn","CREATE or bind account!"],["pt","CREATE or bind account!"]]);!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).kurentoUtils=e()}}((function(){return function e(t,n,o){function i(a,s){if(!n[a]){if(!t[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(r)return r(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var d=n[a]={exports:{}};t[a][0].call(d.exports,(function(e){return i(t[a][1][e]||e)}),d,d.exports,e,t,n,o)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(e,t,n){var o=e("freeice"),i=e("inherits"),r=e("ua-parser-js"),a=e("uuid/v4"),s=e("hark"),c=e("events").EventEmitter,l=e("merge").recursive.bind(void 0,!0),d=e("sdp-translator"),u="undefined"==typeof window?console:window.Logger||console;try{e("kurento-browser-extensions")}catch(e){"undefined"==typeof getScreenConstraints&&(u.warn("screen sharing is not available"),getScreenConstraints=function(e,t){t(new Error("This library is not enabled for screen sharing"))})}var p={audio:!0,video:{width:640,framerate:15}},f=new r("undefined"!=typeof window&&window.navigator?window.navigator.userAgent:"").getBrowser();"IE"===f.name&&function(e){var t=document.createElement("script");t.src=e;var n=document.querySelector("script");n.parentNode.insertBefore(t,n)}("https://cdn.temasys.io/adapterjs/0.15.x/adapter.debug.js");var m=!1;function h(e){e&&u.error(e)}function g(e){e.stop&&e.stop()}function v(e){e.getTracks().forEach(g)}"Chrome"!==f.name&&"Chromium"!==f.name||(m=!0);function y(e,t){var n=[];return function(e,t){"undefined"!=typeof AdapterJS&&"IE"===AdapterJS.webrtcDetectedBrowser&&AdapterJS.webrtcDetectedVersion>=9?t.onsignalingstatechange=e:t.addEventListener("signalingstatechange",e)}((function(){if("stable"===e.signalingState)for(;n.length;){var t=n.shift();e.addIceCandidate(t.candidate,t.callback,t.callback)}}),e),function(o,i){switch(i=i||t,e.signalingState){case"closed":i(new Error("PeerConnection object is closed"));break;case"stable":if(e.remoteDescription){e.addIceCandidate(o,i,i);break}default:n.push({candidate:o,callback:i})}}}function w(e){var t=e.getVideoTracks();if(!t.length)return u.warn("No video tracks available in the video stream"),"";var n=["a=x-google-flag:conference","a=ssrc-group:SIM 1 2 3","a=ssrc:1 cname:localVideo","a=ssrc:1 msid:"+e.id+" "+t[0].id,"a=ssrc:1 mslabel:"+e.id,"a=ssrc:1 label:"+t[0].id,"a=ssrc:2 cname:localVideo","a=ssrc:2 msid:"+e.id+" "+t[0].id,"a=ssrc:2 mslabel:"+e.id,"a=ssrc:2 label:"+t[0].id,"a=ssrc:3 cname:localVideo","a=ssrc:3 msid:"+e.id+" "+t[0].id,"a=ssrc:3 mslabel:"+e.id,"a=ssrc:3 label:"+t[0].id];return n.push(""),n.join("\n")}function b(e,t,n){if(!(this instanceof b))return new b(e,t,n);b.super_.call(this),t instanceof Function&&(n=t,t=void 0),t=t||{},n=(n||h).bind(this);var i,r=this,s=t.localVideo,g=t.remoteVideo,v=t.videoStream,V=t.audioStream,_=t.mediaConstraints,k=t.peerConnection,A=t.sendSource||"webcam",C=t.dataChannelConfig,x=t.dataChannels||!1,T=a(),S=l({iceServers:o()},t.configuration),$=t.onicecandidate;$&&this.on("icecandidate",$);var E=t.oncandidategatheringdone;E&&this.on("candidategatheringdone",E);var M=t.simulcast,R=t.multistream,L=new d.Interop,P=[],O=!1;if(Object.defineProperties(this,{peerConnection:{get:function(){return k}},id:{value:t.id||T,writable:!1},remoteVideo:{get:function(){return g}},localVideo:{get:function(){return s}},dataChannel:{get:function(){return i}},currentFrame:{get:function(){if(g){if(g.readyState<g.HAVE_CURRENT_DATA)throw new Error("No video stream data available");var e=document.createElement("canvas");return e.width=g.videoWidth,e.height=g.videoHeight,e.getContext("2d").drawImage(g,0,0),e}}}}),!k&&(k=new RTCPeerConnection(S),x&&!i)){var N="WebRtcPeer-"+r.id,I=void 0;C&&(N=C.id||N,I=C.options),i=k.createDataChannel(N,I),C&&(i.onopen=C.onopen,i.onclose=C.onclose,i.onmessage=C.onmessage,i.onbufferedamountlow=C.onbufferedamountlow,i.onerror=C.onerror||h)}!k.getLocalStreams&&k.getSenders&&(k.getLocalStreams=function(){var e=new MediaStream;return k.getSenders().forEach((function(t){e.addTrack(t.track)})),[e]}),!k.getRemoteStreams&&k.getReceivers&&(k.getRemoteStreams=function(){var e=new MediaStream;return k.getReceivers().forEach((function(t){e.addTrack(t.track)})),[e]});!function(e,t){"undefined"!=typeof AdapterJS&&"IE"===AdapterJS.webrtcDetectedBrowser&&AdapterJS.webrtcDetectedVersion>=9?t.onicecandidate=e:t.addEventListener("icecandidate",e)}((function(e){var t,n=e.candidate;c.listenerCount(r,"icecandidate")||c.listenerCount(r,"candidategatheringdone")?n?(t=R&&m?L.candidateToUnifiedPlan(n):n,"undefined"==typeof AdapterJS&&r.emit("icecandidate",t),O=!1):O||("undefined"!=typeof AdapterJS&&"IE"===AdapterJS.webrtcDetectedBrowser&&AdapterJS.webrtcDetectedVersion>=9?c.prototype.emit("candidategatheringdone",t):r.emit("candidategatheringdone"),O=!0):O||(P.push(n),n||(O=!0))}),k),k.onaddstream=t.onaddstream,k.onnegotiationneeded=t.onnegotiationneeded,this.on("newListener",(function(e,t){if("icecandidate"===e||"candidategatheringdone"===e)for(;P.length;){var n=P.shift();!n==("candidategatheringdone"===e)&&t(n)}}));var U=y(k);function D(){if(g){g.pause();var e=k.getRemoteStreams()[0];g.srcObject=e,"undefined"!=typeof AdapterJS&&"IE"===AdapterJS.webrtcDetectedBrowser&&AdapterJS.webrtcDetectedVersion>=9?g=attachMediaStream(g,e):g.load()}}function H(e){var t,n;return M&&("Chrome"===f.name||"Chromium"===f.name?e=new RTCSessionDescription({type:e.type,sdp:(t=e.sdp,n=t.indexOf("a=ssrc-group:FID"),(n>0?t.slice(0,n):t)+w(v))}):u.warn("Simulcast is only available in Chrome browser.")),e}function j(){"closed"===k.signalingState&&n('The peer connection object is in "closed" state. This is most likely due to an invocation of the dispose method before accepting in the dialogue'),v&&s&&r.showLocalVideo(),v&&v.getTracks().forEach((function(e){k.addTrack(e,v)})),V&&V.getTracks().forEach((function(e){k.addTrack(e,V)})),n()}if(this.addIceCandidate=function(e,t){var n;n=R&&m?L.candidateToPlanB(e):new RTCIceCandidate(e),t=(t||h).bind(this),U(n,t)},this.generateOffer=function(t){if(t=t.bind(this),"recvonly"===e){var n=!_||"boolean"!=typeof _.audio||_.audio,o=!_||"boolean"!=typeof _.video||_.video;n&&k.addTransceiver("audio",{direction:"recvonly"}),o&&k.addTransceiver("video",{direction:"recvonly"})}else"sendonly"===e&&k.getTransceivers().forEach((function(e){e.direction="sendonly"}));if("undefined"!=typeof AdapterJS&&"IE"===AdapterJS.webrtcDetectedBrowser&&AdapterJS.webrtcDetectedVersion>=9){var i=function(){!function(e){for(var t=(new Date).getTime(),n=0;n<1e7&&!((new Date).getTime()-t>e);n++);}(1e3);var e=k.localDescription;R&&m&&(e=L.toUnifiedPlan(e)),t(null,e.sdp,r.processAnswer.bind(r))};k.createOffer((function(e){k.setLocalDescription(e,i,t)}),t)}else k.createOffer().then((function(e){return e=H(e),k.setLocalDescription(e)})).then((function(){var e=k.localDescription;R&&m&&(e=L.toUnifiedPlan(e)),t(null,e.sdp,r.processAnswer.bind(r))})).catch(t)},this.getLocalSessionDescriptor=function(){return k.localDescription},this.getRemoteSessionDescriptor=function(){return k.remoteDescription},this.showLocalVideo=function(){s.srcObject=v,s.muted=!0,"undefined"!=typeof AdapterJS&&"IE"===AdapterJS.webrtcDetectedBrowser&&AdapterJS.webrtcDetectedVersion>=9&&(s=attachMediaStream(s,v))},this.send=function(e){i&&"open"===i.readyState?i.send(e):u.warn("Trying to send data over a non-existing or closed data channel")},this.processAnswer=function(e,t){t=(t||h).bind(this);var n=new RTCSessionDescription({type:"answer",sdp:e});R&&m&&(n=L.toPlanB(n));if("closed"===k.signalingState)return t("PeerConnection is closed");k.setRemoteDescription(n).then((function(){D(),t()}),t)},this.processOffer=function(e,t){t=t.bind(this);var n=new RTCSessionDescription({type:"offer",sdp:e});R&&m&&(n=L.toPlanB(n));if("closed"===k.signalingState)return t("PeerConnection is closed");k.setRemoteDescription(n).then((function(){return D()})).then((function(){return k.createAnswer()})).then((function(e){return e=H(e),k.setLocalDescription(e)})).then((function(){var e=k.localDescription;R&&m&&(e=L.toUnifiedPlan(e)),t(null,e.sdp)})).catch(t)},"recvonly"===e||v||V)setTimeout(j,0);else{function B(e){void 0===e&&(e=p),"undefined"!=typeof AdapterJS&&"IE"===AdapterJS.webrtcDetectedBrowser&&AdapterJS.webrtcDetectedVersion>=9?navigator.getUserMedia(e,(function(e){v=e,j()}),n):navigator.mediaDevices.getUserMedia(e).then((function(e){v=e,j()})).catch(n)}"webcam"===A?B(_):getScreenConstraints(A,(function(e,t){if(e)return n(e);constraints=[_],constraints.unshift(t),B(l.apply(void 0,constraints))}),T)}this.on("_dispose",(function(){s&&(s.pause(),s.srcObject=null,"undefined"==typeof AdapterJS&&s.load(),s.muted=!1),g&&(g.pause(),g.srcObject=null,"undefined"==typeof AdapterJS&&g.load()),r.removeAllListeners(),"undefined"!=typeof window&&void 0!==window.cancelChooseDesktopMedia&&window.cancelChooseDesktopMedia(T)}))}function V(e){var t="get"+e+"Tracks";return{enumerable:!0,get:function(){if(this.peerConnection){var e=this.peerConnection.getLocalStreams();if(e.length){for(var n,o=0;n=e[o];o++)for(var i,r=n[t](),a=0;i=r[a];a++)if(!i.enabled)return!1;return!0}}},set:function(e){function n(t){t.enabled=e}this.peerConnection.getLocalStreams().forEach((function(e){e[t]().forEach(n)}))}}}function _(e,t){if(!(this instanceof _))return new _(e,t);_.super_.call(this,"recvonly",e,t)}function k(e,t){if(!(this instanceof k))return new k(e,t);k.super_.call(this,"sendonly",e,t)}function A(e,t){if(!(this instanceof A))return new A(e,t);A.super_.call(this,"sendrecv",e,t)}i(b,c),Object.defineProperties(b.prototype,{enabled:{enumerable:!0,get:function(){return this.audioEnabled&&this.videoEnabled},set:function(e){this.audioEnabled=this.videoEnabled=e}},audioEnabled:V("Audio"),videoEnabled:V("Video")}),b.prototype.getLocalStream=function(e){if(this.peerConnection)return this.peerConnection.getLocalStreams()[e||0]},b.prototype.getRemoteStream=function(e){if(this.peerConnection)return this.peerConnection.getRemoteStreams()[e||0]},b.prototype.dispose=function(){var e=this.peerConnection,t=this.dataChannel;try{if(t){if("closed"===t.readyState)return;t.close()}if(e){if("closed"===e.signalingState)return;e.getLocalStreams().forEach(v),e.close()}}catch(e){u.warn("Exception disposing webrtc peer "+e)}"undefined"==typeof AdapterJS&&this.emit("_dispose")},i(_,b),i(k,b),i(A,b),n.bufferizeCandidates=y,n.WebRtcPeerRecvonly=_,n.WebRtcPeerSendonly=k,n.WebRtcPeerSendrecv=A,n.hark=function(e,t){return s(e,t)}},{events:4,freeice:5,hark:8,inherits:9,"kurento-browser-extensions":10,merge:11,"sdp-translator":18,"ua-parser-js":21,"uuid/v4":24}],2:[function(e,t,n){window.addEventListener&&(t.exports=e("./index"))},{"./index":3}],3:[function(e,t,n){var o=e("./WebRtcPeer");n.WebRtcPeer=o},{"./WebRtcPeer":1}],4:[function(e,t,n){var o=Object.create||function(e){var t=function(){};return t.prototype=e,new t},i=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return n},r=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}};function a(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=o(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}t.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._maxListeners=void 0;var s,c=10;try{var l={};Object.defineProperty&&Object.defineProperty(l,"x",{value:0}),s=0===l.x}catch(e){s=!1}function d(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function u(e,t,n){if(t)e.call(n);else for(var o=e.length,i=V(e,o),r=0;r<o;++r)i[r].call(n)}function p(e,t,n,o){if(t)e.call(n,o);else for(var i=e.length,r=V(e,i),a=0;a<i;++a)r[a].call(n,o)}function f(e,t,n,o,i){if(t)e.call(n,o,i);else for(var r=e.length,a=V(e,r),s=0;s<r;++s)a[s].call(n,o,i)}function m(e,t,n,o,i,r){if(t)e.call(n,o,i,r);else for(var a=e.length,s=V(e,a),c=0;c<a;++c)s[c].call(n,o,i,r)}function h(e,t,n,o){if(t)e.apply(n,o);else for(var i=e.length,r=V(e,i),a=0;a<i;++a)r[a].apply(n,o)}function g(e,t,n,i){var r,a,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((a=e._events)?(a.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events),s=a[t]):(a=e._events=o(null),e._eventsCount=0),s){if("function"==typeof s?s=a[t]=i?[n,s]:[s,n]:i?s.unshift(n):s.push(n),!s.warned&&(r=d(e))&&r>0&&s.length>r){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+' "'+String(t)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",c.name,c.message)}}else s=a[t]=n,++e._eventsCount;return e}function v(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=new Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e)}}function y(e,t,n){var o={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=r.call(v,o);return i.listener=n,o.wrapFn=i,i}function w(e,t,n){var o=e._events;if(!o)return[];var i=o[t];return i?"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):V(i,i.length):[]}function b(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function V(e,t){for(var n=new Array(t),o=0;o<t;++o)n[o]=e[o];return n}s?Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||e!=e)throw new TypeError('"defaultMaxListeners" must be a positive number');c=e}}):a.defaultMaxListeners=c,a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return d(this)},a.prototype.emit=function(e){var t,n,o,i,r,a,s="error"===e;if(a=this._events)s=s&&null==a.error;else if(!s)return!1;if(s){if(arguments.length>1&&(t=arguments[1]),t instanceof Error)throw t;var c=new Error('Unhandled "error" event. ('+t+")");throw c.context=t,c}if(!(n=a[e]))return!1;var l="function"==typeof n;switch(o=arguments.length){case 1:u(n,l,this);break;case 2:p(n,l,this,arguments[1]);break;case 3:f(n,l,this,arguments[1],arguments[2]);break;case 4:m(n,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(o-1),r=1;r<o;r++)i[r-1]=arguments[r];h(n,l,this,i)}return!0},a.prototype.addListener=function(e,t){return g(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return g(this,e,t,!0)},a.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,y(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,y(this,e,t)),this},a.prototype.removeListener=function(e,t){var n,i,r,a,s;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(i=this._events))return this;if(!(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=o(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){s=n[a].listener,r=a;break}if(r<0)return this;0===r?n.shift():function(e,t){for(var n=t,o=n+1,i=e.length;o<i;n+=1,o+=1)e[n]=e[o];e.pop()}(n,r),1===n.length&&(i[e]=n[0]),i.removeListener&&this.emit("removeListener",e,s||t)}return this},a.prototype.removeAllListeners=function(e){var t,n,r;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=o(null),this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=o(null):delete n[e]),this;if(0===arguments.length){var a,s=i(n);for(r=0;r<s.length;++r)"removeListener"!==(a=s[r])&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=o(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},a.prototype.listeners=function(e){return w(this,e,!0)},a.prototype.rawListeners=function(e){return w(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):b.call(e,t)},a.prototype.listenerCount=b,a.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],5:[function(e,t,n){"use strict";var o=e("normalice");t.exports=function(t){var n,i={stun:(t||{}).stun||e("./stun.json"),turn:(t||{}).turn||e("./turn.json")},r=(t||{}).stunCount||2,a=(t||{}).turnCount||0;function s(e,t){for(var n,r=[],a=[].concat(i[e]);a.length&&r.length<t;)n=Math.random()*a.length|0,r=r.concat(a.splice(n,1));return r.map((function(t){return"string"==typeof t||t instanceof String?o(e+":"+t):t}))}return n=[].concat(s("stun",r)),a&&(n=n.concat(s("turn",a))),n}},{"./stun.json":6,"./turn.json":7,normalice:12}],6:[function(e,t,n){t.exports=["stun.l.google.com:19302","stun1.l.google.com:19302","stun2.l.google.com:19302","stun3.l.google.com:19302","stun4.l.google.com:19302","stun.ekiga.net","stun.ideasip.com","stun.schlund.de","stun.stunprotocol.org:3478","stun.voiparound.com","stun.voipbuster.com","stun.voipstunt.com","stun.voxgratia.org"]},{}],7:[function(e,t,n){t.exports=[]},{}],8:[function(e,t,n){var o,i=e("wildemitter");"undefined"!=typeof window&&(o=window.AudioContext||window.webkitAudioContext);var r=null;t.exports=function(e,t){var n=new i;if(!o)return n;var a,s,c,l=(t=t||{}).smoothing||.1,d=t.interval||50,u=t.threshold,p=t.play,f=t.history||10,m=!0;r=t.audioContext||r||new o,(c=r.createAnalyser()).fftSize=512,c.smoothingTimeConstant=l,s=new Float32Array(c.frequencyBinCount),e.jquery&&(e=e[0]),e instanceof HTMLAudioElement||e instanceof HTMLVideoElement?(a=r.createMediaElementSource(e),void 0===p&&(p=!0),u=u||-50):(a=r.createMediaStreamSource(e),u=u||-50),a.connect(c),p&&c.connect(r.destination),n.speaking=!1,n.suspend=function(){return r.suspend()},n.resume=function(){return r.resume()},Object.defineProperty(n,"state",{get:function(){return r.state}}),r.onstatechange=function(){n.emit("state_change",r.state)},n.setThreshold=function(e){u=e},n.setInterval=function(e){d=e},n.stop=function(){m=!1,n.emit("volume_change",-100,u),n.speaking&&(n.speaking=!1,n.emit("stopped_speaking")),c.disconnect(),a.disconnect()},n.speakingHistory=[];for(var h=0;h<f;h++)n.speakingHistory.push(0);var g=function(){setTimeout((function(){if(m){var e=function(e,t){var n=-1/0;e.getFloatFrequencyData(t);for(var o=4,i=t.length;o<i;o++)t[o]>n&&t[o]<0&&(n=t[o]);return n}(c,s);n.emit("volume_change",e,u);var t=0;if(e>u&&!n.speaking){for(var o=n.speakingHistory.length-3;o<n.speakingHistory.length;o++)t+=n.speakingHistory[o];t>=2&&(n.speaking=!0,n.emit("speaking"))}else if(e<u&&n.speaking){for(o=0;o<n.speakingHistory.length;o++)t+=n.speakingHistory[o];0==t&&(n.speaking=!1,n.emit("stopped_speaking"))}n.speakingHistory.shift(),n.speakingHistory.push(0+(e>u)),g()}}),d)};return g(),n}},{wildemitter:25}],9:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},{}],10:[function(e,t,n){},{}],11:[function(e,t,n){!function(e){var n=function(e){return i(!0===e,!1,arguments)};function o(e,t){if("object"!==r(e))return t;for(var n in t)"object"===r(e[n])&&"object"===r(t[n])?e[n]=o(e[n],t[n]):e[n]=t[n];return e}function i(e,t,i){var a=i[0],s=i.length;(e||"object"!==r(a))&&(a={});for(var c=0;c<s;++c){var l=i[c];if("object"===r(l))for(var d in l)if("__proto__"!==d){var u=e?n.clone(l[d]):l[d];a[d]=t?o(a[d],u):u}}return a}function r(e){return{}.toString.call(e).slice(8,-1).toLowerCase()}n.recursive=function(e){return i(!0===e,!0,arguments)},n.clone=function(e){var t,o,i=e,a=r(e);if("array"===a)for(i=[],o=e.length,t=0;t<o;++t)i[t]=n.clone(e[t]);else if("object"===a)for(t in i={},e)i[t]=n.clone(e[t]);return i},e?t.exports=n:window.merge=n}("object"==typeof t&&t&&"object"==typeof t.exports&&t.exports)},{}],12:[function(e,t,n){var o=["stun:","turn:"];t.exports=function(e){var t,n,i=(e||{}).url||e,r={};return"string"==typeof i||i instanceof String?(i=i.trim(),(t=o[o.indexOf(i.slice(0,5))])?(n=(i=i.slice(5)).split("@"),r.username=e.username,r.credential=e.credential,n.length>1&&(i=n[1],n=n[0].split(":"),r.username=n[0],r.credential=(e||{}).credential||n[1]||""),r.url=t+i,r.urls=[r.url],r):e):e}},{}],13:[function(e,t,n){var o=t.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["value","uri","config"],format:function(e){return null!=e.config?"extmap:%s %s %s":"extmap:%s %s"}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_]*):(.*)/,names:["id","attribute","value"],format:"ssrc:%d %s:%s"},{push:"ssrcGroups",reg:/^ssrc-group:(\w*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{push:"invalid",names:["value"]}]};Object.keys(o).forEach((function(e){o[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))}))},{}],14:[function(e,t,n){var o=e("./parser"),i=e("./writer");n.write=i,n.parse=o.parse,n.parseFmtpConfig=o.parseFmtpConfig,n.parsePayloads=o.parsePayloads,n.parseRemoteCandidates=o.parseRemoteCandidates},{"./parser":15,"./writer":16}],15:[function(e,t,n){var o=function(e){return String(Number(e))===e?Number(e):e},i=function(e,t,n){var i=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:i&&!t[e.name]&&(t[e.name]={});var r=e.push?{}:i?t[e.name]:t;!function(e,t,n,i){if(i&&!n)t[i]=o(e[1]);else for(var r=0;r<n.length;r+=1)null!=e[r+1]&&(t[n[r]]=o(e[r+1]))}(n.match(e.reg),r,e.names,e.name),e.push&&t[e.push].push(r)},r=e("./grammar"),a=RegExp.prototype.test.bind(/^([a-z])=(.*)/);n.parse=function(e){var t={},n=[],o=t;return e.split(/(\r\n|\r|\n)/).filter(a).forEach((function(e){var t=e[0],a=e.slice(2);"m"===t&&(n.push({rtp:[],fmtp:[]}),o=n[n.length-1]);for(var s=0;s<(r[t]||[]).length;s+=1){var c=r[t][s];if(c.reg.test(a))return i(c,o,a)}})),t.media=n,t};var s=function(e,t){var n=t.split("=");return 2===n.length&&(e[n[0]]=o(n[1])),e};n.parseFmtpConfig=function(e){return e.split(/\;\s?/).reduce(s,{})},n.parsePayloads=function(e){return e.split(" ").map(Number)},n.parseRemoteCandidates=function(e){for(var t=[],n=e.split(" ").map(o),i=0;i<n.length;i+=3)t.push({component:n[i],ip:n[i+1],port:n[i+2]});return t}},{"./grammar":13}],16:[function(e,t,n){var o=e("./grammar"),i=/%[sdv%]/g,r=function(e){var t=1,n=arguments,o=n.length;return e.replace(i,(function(e){if(t>=o)return e;var i=n[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(i);case"%d":return Number(i);case"%v":return""}}))},a=function(e,t,n){var o=[e+"="+(t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format)];if(t.names)for(var i=0;i<t.names.length;i+=1){var a=t.names[i];t.name?o.push(n[t.name][a]):o.push(n[t.names[i]])}else o.push(n[t.name]);return r.apply(null,o)},s=["v","o","s","i","u","e","p","c","b","t","r","z","a"],c=["i","c","b","a"];t.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var n=t.outerOrder||s,i=t.innerOrder||c,r=[];return n.forEach((function(t){o[t].forEach((function(n){n.name in e&&null!=e[n.name]?r.push(a(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){r.push(a(t,n,e))}))}))})),e.media.forEach((function(e){r.push(a("m",o.m[0],e)),i.forEach((function(t){o[t].forEach((function(n){n.name in e&&null!=e[n.name]?r.push(a(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){r.push(a(t,n,e))}))}))}))})),r.join("\r\n")+"\r\n"}},{"./grammar":13}],17:[function(e,t,n){t.exports=function e(t){if(!t)return!1;if(this.length!=t.length)return!1;for(var n=0,o=this.length;n<o;n++)if(this[n]instanceof Array&&t[n]instanceof Array){if(!e.apply(this[n],[t[n]]))return!1}else if(this[n]!=t[n])return!1;return!0}},{}],18:[function(e,t,n){n.Interop=e("./interop")},{"./interop":19}],19:[function(e,t,n){"use strict";var o=e("./transform"),i=e("./array-equals");function r(){this.cache={mlB2UMap:{},mlU2BMap:{}}}t.exports=r,r.prototype.candidateToUnifiedPlan=function(e){var t=new RTCIceCandidate(e);return t.sdpMLineIndex=this.cache.mlB2UMap[t.sdpMLineIndex],t},r.prototype.candidateToPlanB=function(e){var t=new RTCIceCandidate(e);if(0===t.sdpMid.indexOf("audio"))t.sdpMid="audio";else{if(0!==t.sdpMid.indexOf("video"))throw new Error("candidate with "+t.sdpMid+" not allowed");t.sdpMid="video"}return t.sdpMLineIndex=this.cache.mlU2BMap[t.sdpMLineIndex],t},r.prototype.getFirstSendingIndexFromAnswer=function(e){if(!this.cache.answer)return null;var t=o.parse(this.cache.answer);if(t&&t.media&&Array.isArray(t.media))for(var n=0;n<t.media.length;n++)if(t.media[n].type==e&&(!t.media[n].direction||"sendrecv"===t.media[n].direction||"sendonly"===t.media[n].direction))return n;return null},r.prototype.toPlanB=function(e){var t=this;if("object"!=typeof e||null===e||"string"!=typeof e.sdp)return console.warn("An empty description was passed as an argument."),e;var n=o.parse(e.sdp);if(void 0===n.media||!Array.isArray(n.media)||0===n.media.length)return console.warn("The description has no media."),e;if(n.media.length<=3&&n.media.every((function(e){return-1!==["video","audio","data"].indexOf(e.mid)})))return console.warn("This description does not look like Unified Plan."),e;for(var i=e.sdp,r=!1,a=0;a<n.media.length;a++){n.media[a].rtp.forEach((function(e){if("NULL"===e.codec){r=!0;var n=o.parse(t.cache.offer);e.codec=n.media[a].rtp[0].codec}}))}r&&(i=o.write(n)),this.cache[e.type]=i;var s=n.media;n.media=[];var c={},l=[];s.forEach((function(e){if(("string"!=typeof e.rtcpMux||"rtcp-mux"!==e.rtcpMux)&&"inactive"!==e.direction)throw new Error("Cannot convert to Plan B because m-lines without the rtcp-mux attribute were found.");if(void 0!==c[e.type]&&"inactive"!==c[e.type].direction||(c[e.type]=e),e.protocol!=c[e.type].protocol)throw new Error("Cannot convert to Plan B because m-lines have different protocols and this library does not have support for that");if(e.payloads!=c[e.type].payloads)throw new Error("Cannot convert to Plan B because m-lines have different payloads and this library does not have support for that")})),s.forEach((function(e){if("application"===e.type)return n.media.push(e),void l.push(e.mid);"object"==typeof e.sources&&Object.keys(e.sources).forEach((function(t){"object"!=typeof c[e.type].sources&&(c[e.type].sources={}),c[e.type].sources[t]=e.sources[t],void 0!==e.msid&&(c[e.type].sources[t].msid=e.msid)})),void 0!==e.ssrcGroups&&Array.isArray(e.ssrcGroups)&&(void 0!==c[e.type].ssrcGroups&&Array.isArray(c[e.type].ssrcGroups)||(c[e.type].ssrcGroups=[]),c[e.type].ssrcGroups=c[e.type].ssrcGroups.concat(e.ssrcGroups)),c[e.type]===e&&(e.mid=e.type,delete e.bundleOnly,delete e.msid,e.type==s[0].type?(l.unshift(e.type),n.media.unshift(e)):(l.push(e.type),n.media.push(e)))})),void 0!==n.groups&&n.groups.some((function(e){if("BUNDLE"===e.type)return e.mids=l.join(" "),!0})),n.msidSemantic={semantic:"WMS",token:"*"};var d=o.write(n);return new RTCSessionDescription({type:e.type,sdp:d})},r.prototype.toUnifiedPlan=function(e){var t=this;if("object"!=typeof e||null===e||"string"!=typeof e.sdp)return console.warn("An empty description was passed as an argument."),e;var n=o.parse(e.sdp);if(void 0===n.media||!Array.isArray(n.media)||0===n.media.length)return console.warn("The description has no media."),e;if(n.media.length>3||!n.media.every((function(e){return-1!==["video","audio","data"].indexOf(e.mid)})))return console.warn("This description does not look like Plan B."),e;var r=[];n.media.forEach((function(e){r.push(e.mid)}));var a,s,c=!1;if(void 0!==n.groups&&Array.isArray(n.groups)&&(c=n.groups.every((function(e){return"BUNDLE"!==e.type||i.apply(e.mids.sort(),[r.sort()])}))),!c){var l=!1;if(n.media.forEach((function(e){"inactive"!==e.direction&&(l=!0)})),l)throw new Error("Cannot convert to Unified Plan because m-lines that are not bundled were found.")}if("answer"===e.type)a="offer";else{if("offer"!==e.type)throw new Error("Type '"+e.type+"' not supported.");a="answer"}void 0!==this.cache[a]&&(s=o.parse(this.cache[a]));var d,u,p,f,m={audio:{},video:{}},h={},g=0,v=0,y={},w={},b={},V={};if(n.media.forEach((function(n){if(("string"!=typeof n.rtcpMux||"rtcp-mux"!==n.rtcpMux)&&"inactive"!==n.direction)throw new Error("Cannot convert to Unified Plan because m-lines without the rtcp-mux attribute were found.");if("application"!==n.type){var o=n.sources,i=n.ssrcGroups,r=n.port;if(void 0!==n.candidates&&(d=void 0!==d?d.concat(n.candidates):n.candidates),void 0!==u&&void 0!==n.iceUfrag&&u!=n.iceUfrag)throw new Error("Only BUNDLE supported, iceUfrag must be the same for all m-lines.\n\tLast iceUfrag: "+u+"\n\tNew iceUfrag: "+n.iceUfrag);if(void 0!==n.iceUfrag&&(u=n.iceUfrag),void 0!==p&&void 0!==n.icePwd&&p!=n.icePwd)throw new Error("Only BUNDLE supported, icePwd must be the same for all m-lines.\n\tLast icePwd: "+p+"\n\tNew icePwd: "+n.icePwd);if(void 0!==n.icePwd&&(p=n.icePwd),void 0!==f&&void 0!==n.fingerprint&&(f.type!=n.fingerprint.type||f.hash!=n.fingerprint.hash))throw new Error("Only BUNDLE supported, fingerprint must be the same for all m-lines.\n\tLast fingerprint: "+JSON.stringify(f)+"\n\tNew fingerprint: "+JSON.stringify(n.fingerprint));void 0!==n.fingerprint&&(f=n.fingerprint),w[n.type]=n.payloads,b[n.type]=n.rtcpFb,V[n.type]=n.rtp;var a={};void 0!==i&&Array.isArray(i)&&i.forEach((function(e){void 0!==e.ssrcs&&Array.isArray(e.ssrcs)&&e.ssrcs.forEach((function(t){void 0===a[t]&&(a[t]=[]),a[t].push(e)}))}));var c={};if("object"==typeof o)delete n.sources,delete n.ssrcGroups,delete n.candidates,delete n.iceUfrag,delete n.icePwd,delete n.fingerprint,delete n.port,delete n.mid,Object.keys(o).forEach((function(i){var l;"offer"!==e.type||o[i].msid?(void 0!==a[i]&&Array.isArray(a[i])&&a[i].some((function(e){return e.ssrcs.some((function(e){if("object"==typeof c[e])return l=c[e],!0}))})),"object"==typeof l?(l.sources[i]=o[i],delete o[i].msid):(l=Object.create(n),c[i]=l,void 0!==o[i].msid&&(l.msid=o[i].msid,delete o[i].msid),l.sources={},l.sources[i]=o[i],l.ssrcGroups=a[i],void 0!==s&&void 0!==s.media&&Array.isArray(s.media)&&s.media.forEach((function(e){"object"==typeof e.sources&&Object.keys(e.sources).forEach((function(t){t===i&&(l.mid=e.mid)}))})),void 0===l.mid&&(l.mid=[n.type,"-",i].join("")),l.candidates=d,l.iceUfrag=u,l.icePwd=p,l.fingerprint=f,l.port=r,h[l.mid]=l,y[v]=l.sources,t.cache.mlU2BMap[v]=g,void 0===t.cache.mlB2UMap[g]&&(t.cache.mlB2UMap[g]=v),v++)):m[n.type][i]=o[i]}));else{var l=n;l.candidates=d,l.iceUfrag=u,l.icePwd=p,l.fingerprint=f,l.port=r,h[l.mid]=l,t.cache.mlU2BMap[v]=g,void 0===t.cache.mlB2UMap[g]&&(t.cache.mlB2UMap[g]=v)}g++}else h[n.mid]=n})),n.media=[],r=[],"answer"===e.type)for(var _=0;_<s.media.length;_++){var k=s.media[_];delete k.msid,delete k.sources,delete k.ssrcGroups,void 0===y[_]?k.direction&&"sendrecv"!==k.direction?"sendonly"===k.direction&&(k.direction="inactive"):k.direction="recvonly":k.direction&&"sendrecv"!==k.direction?"recvonly"===k.direction&&(k.direction="sendonly"):k.direction="sendrecv",k.sources=y[_],k.candidates=d,k.iceUfrag=u,k.icePwd=p,k.fingerprint=f,k.rtp=V[k.type],k.payloads=w[k.type],k.rtcpFb=b[k.type],n.media.push(k),"string"==typeof k.mid&&r.push(k.mid)}else void 0!==s&&void 0!==s.media&&Array.isArray(s.media)&&s.media.forEach((function(e){r.push(e.mid),void 0!==h[e.mid]?n.media.push(h[e.mid]):(delete e.msid,delete e.sources,delete e.ssrcGroups,e.direction&&"sendrecv"!==e.direction||(e.direction="sendonly"),e.direction&&"recvonly"!==e.direction||(e.direction="inactive"),function(e){void 0!==e.setup&&("active"===e.setup?e.setup="passive":"passive"===e.setup&&(e.setup="active"))}(e),n.media.push(e))})),Object.keys(h).forEach((function(e){if(-1===r.indexOf(e))if(r.push(e),"recvonly"===h[e].direction){var t=!1;n.media.some((function(n){if(("sendrecv"===n.direction||"sendonly"===n.direction)&&n.type===h[e].type)return Object.keys(h[e].sources).forEach((function(t){n.sources[t]=h[e].sources[t]})),t=!0,!0})),t||n.media.push(h[e])}else n.media.push(h[e])}));["audio","video"].forEach((function(e){if(n&&n.media&&Array.isArray(n.media)){var o=null;if(Object.keys(m[e]).length>0&&null===(o=t.getFirstSendingIndexFromAnswer(e)))for(var i=0;i<n.media.length;i++)if(n.media[i].type===e){o=i;break}if(o&&n.media.length>o){var r=n.media[o];Object.keys(m[e]).forEach((function(t){r.sources&&r.sources[t]&&console.warn("Replacing an existing SSRC."),r.sources||(r.sources={}),r.sources[t]=m[e][t]}))}}})),void 0!==n.groups&&n.groups.some((function(e){if("BUNDLE"===e.type)return e.mids=r.join(" "),!0})),n.msidSemantic={semantic:"WMS",token:"*"};var A=o.write(n);return this.cache[e.type]=A,new RTCSessionDescription({type:e.type,sdp:A})}},{"./array-equals":17,"./transform":20}],20:[function(e,t,n){var o=e("sdp-transform");n.write=function(e,t){return void 0!==e&&void 0!==e.media&&Array.isArray(e.media)&&e.media.forEach((function(e){void 0!==e.sources&&0!==Object.keys(e.sources).length&&(e.ssrcs=[],Object.keys(e.sources).forEach((function(t){var n=e.sources[t];Object.keys(n).forEach((function(o){e.ssrcs.push({id:t,attribute:o,value:n[o]})}))})),delete e.sources),void 0!==e.ssrcGroups&&Array.isArray(e.ssrcGroups)&&e.ssrcGroups.forEach((function(e){void 0!==e.ssrcs&&Array.isArray(e.ssrcs)&&(e.ssrcs=e.ssrcs.join(" "))}))})),void 0!==e&&void 0!==e.groups&&Array.isArray(e.groups)&&e.groups.forEach((function(e){void 0!==e.mids&&Array.isArray(e.mids)&&(e.mids=e.mids.join(" "))})),o.write(e,t)},n.parse=function(e){var t=o.parse(e);return void 0!==t&&void 0!==t.media&&Array.isArray(t.media)&&t.media.forEach((function(e){void 0!==e.ssrcs&&Array.isArray(e.ssrcs)&&(e.sources={},e.ssrcs.forEach((function(t){e.sources[t.id]||(e.sources[t.id]={}),e.sources[t.id][t.attribute]=t.value})),delete e.ssrcs),void 0!==e.ssrcGroups&&Array.isArray(e.ssrcGroups)&&e.ssrcGroups.forEach((function(e){"string"==typeof e.ssrcs&&(e.ssrcs=e.ssrcs.split(" "))}))})),void 0!==t&&void 0!==t.groups&&Array.isArray(t.groups)&&t.groups.forEach((function(e){"string"==typeof e.mids&&(e.mids=e.mids.split(" "))})),t}},{"sdp-transform":14}],21:[function(e,t,n){!function(e,o){"use strict";var i="function",r="undefined",a="object",s="model",c="name",l="type",d="vendor",u="version",p="architecture",f="console",m="mobile",h="tablet",g="smarttv",v="wearable",y={extend:function(e,t){var n={};for(var o in e)t[o]&&t[o].length%2==0?n[o]=t[o].concat(e[o]):n[o]=e[o];return n},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:o},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},w={rgx:function(e,t){for(var n,r,s,c,l,d,u=0;u<t.length&&!l;){var p=t[u],f=t[u+1];for(n=r=0;n<p.length&&!l;)if(l=p[n++].exec(e))for(s=0;s<f.length;s++)d=l[++r],typeof(c=f[s])===a&&c.length>0?2==c.length?typeof c[1]==i?this[c[0]]=c[1].call(this,d):this[c[0]]=c[1]:3==c.length?typeof c[1]!==i||c[1].exec&&c[1].test?this[c[0]]=d?d.replace(c[1],c[2]):o:this[c[0]]=d?c[1].call(this,d,c[2]):o:4==c.length&&(this[c[0]]=d?c[3].call(this,d.replace(c[1],c[2])):o):this[c]=d||o;u+=2}},str:function(e,t){for(var n in t)if(typeof t[n]===a&&t[n].length>0){for(var i=0;i<t[n].length;i++)if(y.has(t[n][i],e))return"?"===n?o:n}else if(y.has(t[n],e))return"?"===n?o:n;return e}},b={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},V={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[c,u],[/(opios)[\/\s]+([\w\.]+)/i],[[c,"Opera Mini"],u],[/\s(opr)\/([\w\.]+)/i],[[c,"Opera"],u],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(bidubrowser|baidubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[c,u],[/(konqueror)\/([\w\.]+)/i],[[c,"Konqueror"],u],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[c,"IE"],u],[/(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i],[[c,"Edge"],u],[/(yabrowser)\/([\w\.]+)/i],[[c,"Yandex"],u],[/(Avast)\/([\w\.]+)/i],[[c,"Avast Secure Browser"],u],[/(AVG)\/([\w\.]+)/i],[[c,"AVG Secure Browser"],u],[/(puffin)\/([\w\.]+)/i],[[c,"Puffin"],u],[/(focus)\/([\w\.]+)/i],[[c,"Firefox Focus"],u],[/(opt)\/([\w\.]+)/i],[[c,"Opera Touch"],u],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[c,"UCBrowser"],u],[/(comodo_dragon)\/([\w\.]+)/i],[[c,/_/g," "],u],[/(windowswechat qbcore)\/([\w\.]+)/i],[[c,"WeChat(Win) Desktop"],u],[/(micromessenger)\/([\w\.]+)/i],[[c,"WeChat"],u],[/(brave)\/([\w\.]+)/i],[[c,"Brave"],u],[/(qqbrowserlite)\/([\w\.]+)/i],[c,u],[/(QQ)\/([\d\.]+)/i],[c,u],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[c,u],[/(baiduboxapp)[\/\s]?([\w\.]+)/i],[c,u],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[c,u],[/(MetaSr)[\/\s]?([\w\.]+)/i],[c],[/(LBBROWSER)/i],[c],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[u,[c,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[u,[c,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[c,u],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[u,[c,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[c,/(.+)/,"$1 WebView"],u],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[c,/(.+(?:g|us))(.+)/,"$1 $2"],u],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[u,[c,"Android Browser"]],[/(sailfishbrowser)\/([\w\.]+)/i],[[c,"Sailfish Browser"],u],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[c,u],[/(dolfin)\/([\w\.]+)/i],[[c,"Dolphin"],u],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[c,"360 Browser"]],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[c,"Chrome"],u],[/(coast)\/([\w\.]+)/i],[[c,"Opera Coast"],u],[/fxios\/([\w\.-]+)/i],[u,[c,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[u,[c,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[u,c],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[c,"GSA"],u],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[c,[u,w.str,b.browser.oldsafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[c,u],[/(navigator|netscape)\/([\w\.-]+)/i],[[c,"Netscape"],u],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[c,u]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[p,"amd64"]],[/(ia32(?=;))/i],[[p,y.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[p,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[p,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[p,/ower/,"",y.lowerize]],[/(sun4\w)[;\)]/i],[[p,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[p,y.lowerize]]],device:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[s,d,[l,h]],[/applecoremedia\/[\w\.]+ \((ipad)/],[s,[d,"Apple"],[l,h]],[/(apple\s{0,1}tv)/i],[[s,"Apple TV"],[d,"Apple"],[l,g]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[d,s,[l,h]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[s,[d,"Amazon"],[l,h]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[s,w.str,b.device.amazon.model],[d,"Amazon"],[l,m]],[/android.+aft([bms])\sbuild/i],[s,[d,"Amazon"],[l,g]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[s,d,[l,m]],[/\((ip[honed|\s\w*]+);/i],[s,[d,"Apple"],[l,m]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[d,s,[l,m]],[/\(bb10;\s(\w+)/i],[s,[d,"BlackBerry"],[l,m]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[s,[d,"Asus"],[l,h]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[d,"Sony"],[s,"Xperia Tablet"],[l,h]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[s,[d,"Sony"],[l,m]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[d,s,[l,f]],[/android.+;\s(shield)\sbuild/i],[s,[d,"Nvidia"],[l,f]],[/(playstation\s[34portablevi]+)/i],[s,[d,"Sony"],[l,f]],[/(sprint\s(\w+))/i],[[d,w.str,b.device.sprint.vendor],[s,w.str,b.device.sprint.model],[l,m]],[/(htc)[;_\s-]+([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[d,[s,/_/g," "],[l,m]],[/(nexus\s9)/i],[s,[d,"HTC"],[l,h]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p|vog-l29|ane-lx1|eml-l29|ele-l29)/i],[s,[d,"Huawei"],[l,m]],[/android.+(bah2?-a?[lw]\d{2})/i],[s,[d,"Huawei"],[l,h]],[/(microsoft);\s(lumia[\s\w]+)/i],[d,s,[l,m]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[s,[d,"Microsoft"],[l,f]],[/(kin\.[onetw]{3})/i],[[s,/\./g," "],[d,"Microsoft"],[l,m]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[s,[d,"Motorola"],[l,m]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[s,[d,"Motorola"],[l,h]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[d,y.trim],[s,y.trim],[l,g]],[/hbbtv.+maple;(\d+)/i],[[s,/^/,"SmartTV"],[d,"Samsung"],[l,g]],[/\(dtv[\);].+(aquos)/i],[s,[d,"Sharp"],[l,g]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[d,"Samsung"],s,[l,h]],[/smart-tv.+(samsung)/i],[d,[l,g],s],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[d,"Samsung"],s,[l,m]],[/sie-(\w*)/i],[s,[d,"Siemens"],[l,m]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[d,"Nokia"],s,[l,m]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[s,[d,"Acer"],[l,h]],[/android.+([vl]k\-?\d{3})\s+build/i],[s,[d,"LG"],[l,h]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[d,"LG"],s,[l,h]],[/(lg) netcast\.tv/i],[d,s,[l,g]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[s,[d,"LG"],[l,m]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[d,s,[l,h]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[s,[d,"Lenovo"],[l,h]],[/(lenovo)[_\s-]?([\w-]+)/i],[d,s,[l,m]],[/linux;.+((jolla));/i],[d,s,[l,m]],[/((pebble))app\/[\d\.]+\s/i],[d,s,[l,v]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[d,s,[l,m]],[/crkey/i],[[s,"Chromecast"],[d,"Google"],[l,g]],[/android.+;\s(glass)\s\d/i],[s,[d,"Google"],[l,v]],[/android.+;\s(pixel c)[\s)]/i],[s,[d,"Google"],[l,h]],[/android.+;\s(pixel( [23])?( xl)?)[\s)]/i],[s,[d,"Google"],[l,m]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:a\d|one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]?[\w\s]+))\s+build/i],[[s,/_/g," "],[d,"Xiaomi"],[l,m]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]?[\w\s]+))\s+build/i],[[s,/_/g," "],[d,"Xiaomi"],[l,h]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[s,[d,"Meizu"],[l,m]],[/(mz)-([\w-]{2,})/i],[[d,"Meizu"],s,[l,m]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})[\s)]/i],[s,[d,"OnePlus"],[l,m]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[s,[d,"RCA"],[l,h]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[s,[d,"Dell"],[l,h]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[s,[d,"Verizon"],[l,h]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[d,"Barnes & Noble"],s,[l,h]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[s,[d,"NuVision"],[l,h]],[/android.+;\s(k88)\sbuild/i],[s,[d,"ZTE"],[l,h]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[s,[d,"Swiss"],[l,m]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[s,[d,"Swiss"],[l,h]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[s,[d,"Zeki"],[l,h]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[d,"Dragon Touch"],s,[l,h]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[s,[d,"Insignia"],[l,h]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[s,[d,"NextBook"],[l,h]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[d,"Voice"],s,[l,m]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[d,"LvTel"],s,[l,m]],[/android.+;\s(PH-1)\s/i],[s,[d,"Essential"],[l,m]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[s,[d,"Envizen"],[l,h]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[d,s,[l,h]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[s,[d,"MachSpeed"],[l,h]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[d,s,[l,h]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[s,[d,"Rotor"],[l,h]],[/android.+(KS(.+))\s+build/i],[s,[d,"Amazon"],[l,h]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[d,s,[l,h]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[l,y.lowerize],d,s],[/[\s\/\(](smart-?tv)[;\)]/i],[[l,g]],[/(android[\w\.\s\-]{0,9});.+build/i],[s,[d,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[u,[c,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[u,[c,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[c,u],[/rv\:([\w\.]{1,9}).+(gecko)/i],[u,c]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[c,u],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[c,[u,w.str,b.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[c,"Windows"],[u,w.str,b.os.windows.version]],[/\((bb)(10);/i],[[c,"BlackBerry"],u],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i],[c,u],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[c,"Symbian"],u],[/\((series40);/i],[c],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[c,"Firefox OS"],u],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[c,u],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[c,"Chromium OS"],u],[/(sunos)\s?([\w\.\d]*)/i],[[c,"Solaris"],u],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[c,u],[/(haiku)\s(\w+)/i],[c,u],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[u,/_/g,"."],[c,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[c,"Mac OS"],[u,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[c,u]]},_=function(t,n){if("object"==typeof t&&(n=t,t=o),!(this instanceof _))return new _(t,n).getResult();var i=t||(e&&e.navigator&&e.navigator.userAgent?e.navigator.userAgent:""),r=n?y.extend(V,n):V;return this.getBrowser=function(){var e={name:o,version:o};return w.rgx.call(e,i,r.browser),e.major=y.major(e.version),e},this.getCPU=function(){var e={architecture:o};return w.rgx.call(e,i,r.cpu),e},this.getDevice=function(){var e={vendor:o,model:o,type:o};return w.rgx.call(e,i,r.device),e},this.getEngine=function(){var e={name:o,version:o};return w.rgx.call(e,i,r.engine),e},this.getOS=function(){var e={name:o,version:o};return w.rgx.call(e,i,r.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i=e,this},this};_.VERSION="0.7.22",_.BROWSER={NAME:c,MAJOR:"major",VERSION:u},_.CPU={ARCHITECTURE:p},_.DEVICE={MODEL:s,VENDOR:d,TYPE:l,CONSOLE:f,MOBILE:m,SMARTTV:g,TABLET:h,WEARABLE:v,EMBEDDED:"embedded"},_.ENGINE={NAME:c,VERSION:u},_.OS={NAME:c,VERSION:u},typeof n!==r?(typeof t!==r&&t.exports&&(n=t.exports=_),n.UAParser=_):e&&(e.UAParser=_);var k=e&&(e.jQuery||e.Zepto);if(k&&!k.ua){var A=new _;k.ua=A.getResult(),k.ua.get=function(){return A.getUA()},k.ua.set=function(e){A.setUA(e);var t=A.getResult();for(var n in t)k.ua[n]=t[n]}}}("object"==typeof window?window:this)},{}],22:[function(e,t,n){for(var o=[],i=0;i<256;++i)o[i]=(i+256).toString(16).substr(1);t.exports=function(e,t){var n=t||0,i=o;return[i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]]].join("")}},{}],23:[function(e,t,n){var o="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(o){var i=new Uint8Array(16);t.exports=function(){return o(i),i}}else{var r=new Array(16);t.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}},{}],24:[function(e,t,n){var o=e("./lib/rng"),i=e("./lib/bytesToUuid");t.exports=function(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||o)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[r+s]=a[s];return t||i(a)}},{"./lib/bytesToUuid":22,"./lib/rng":23}],25:[function(e,t,n){function o(){}t.exports=o,o.mixin=function(e){var t=e.prototype||e;t.isWildEmitter=!0,t.on=function(e,t,n){this.callbacks=this.callbacks||{};var o=3===arguments.length,i=o?arguments[1]:void 0,r=o?arguments[2]:arguments[1];return r._groupName=i,(this.callbacks[e]=this.callbacks[e]||[]).push(r),this},t.once=function(e,t,n){var o=this,i=3===arguments.length,r=i?arguments[1]:void 0,a=i?arguments[2]:arguments[1];function s(){o.off(e,s),a.apply(this,arguments)}return this.on(e,r,s),this},t.releaseGroup=function(e){var t,n,o,i;for(t in this.callbacks=this.callbacks||{},this.callbacks)for(n=0,o=(i=this.callbacks[t]).length;n<o;n++)i[n]._groupName===e&&(i.splice(n,1),n--,o--);return this},t.off=function(e,t){this.callbacks=this.callbacks||{};var n,o=this.callbacks[e];return o?1===arguments.length?(delete this.callbacks[e],this):(-1!==(n=o.indexOf(t))&&(o.splice(n,1),0===o.length&&delete this.callbacks[e]),this):this},t.emit=function(e){this.callbacks=this.callbacks||{};var t,n,o,i=[].slice.call(arguments,1),r=this.callbacks[e],a=this.getWildcardCallbacks(e);if(r)for(t=0,n=(o=r.slice()).length;t<n&&o[t];++t)o[t].apply(this,i);if(a)for(n=a.length,t=0,n=(o=a.slice()).length;t<n&&o[t];++t)o[t].apply(this,[e].concat(i));return this},t.getWildcardCallbacks=function(e){this.callbacks=this.callbacks||{};var t,n,o=[];for(t in this.callbacks)n=t.split("*"),("*"===t||2===n.length&&e.slice(0,n[0].length)===n[0])&&(o=o.concat(this.callbacks[t]));return o}},o.mixin(o)},{}]},{},[2])(2)}));var mod1,mod2,mod5,curIP="",aonly=1,cam1=(altlang=["en","ru","es","fr","cn","pt"],getCookie("d1")),cam2=getCookie("d2"),scanned=getCookie("s1");const soundEffect=new Audio;soundEffect.autoplay=!0;var snd_clicked=!1,oldColor=null,selectedFile=null,warning="",waiter="",sorry="",hola="",caller="",requ="",creatu="",chat_shown=1,role_zero_has_square=(check_iOS(),0),temporary=0,cammode=0,voting_shown=0,scrolled=!1,heard_info=!1;function getIP(e){curIP=e.ip,$("curip").value=curIP}function ajax_chat(){fetch("https://"+window.location.hostname+":8453/log.html").then((e=>e.text())).then((e=>{$("message_box").innerHTML=e})).catch((e=>console.log(e)))}function change_lang(e){$("head1")&&($("head1").innerHTML=heads1.get(e)),$("abouter")&&($("abouter").innerHTML=about.get(e)),$("helper")&&($("helper").innerHTML=help.get(e)),$("leftlab")&&($("leftlab").innerHTML=left_label.get(e)),$("rightlab")&&($("rightlab").innerHTML=right_label.get(e)),$("for_por1")&&($("for_por1").innerHTML=for_por.get(e)),$("for_por2")&&($("for_por2").innerHTML=for_por.get(e)),warning=warner.get(e),waiter=waiter_.get(e),sorry=sorry_.get(e),hola=hola_.get(e),caller=caller_.get(e),requ=requ_.get(e),creatu=creatu_.get(e),mod1.content.innerHTML=about_content.get(e),mod2.content.innerHTML=help_content.get(e),"undefined"!=typeof mod3&&null!==mod3&&(mod3.content.innerHTML=left_content.get(e)),"undefined"!=typeof mod4&&null!==mod4&&(mod4.content.innerHTML=right_content.get(e))}function checkWebRTC(){var e=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||window.RTCPeerConnection;if(window.navigator.userAgent.indexOf("Edge")>-1||!e)return alert("Please use a different browser with WebRTC support!"),console.log("Bad WebRTC non-compatible bro"),!1;try{(new RTCPeerConnection).addTransceiver("audio")}catch(e){console.log(e),alert("Please use a newer browser with full WebRTC support!")}}function toggleHeader(e){fetch("https://"+window.location.hostname+":8453/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((t=>{let n=t;2==n&&(n=1),1==e&&1==n&&aonly&&($("room-header").style.color="rgb(153, 204, 255)"==$("room-header").style.color?oldColor:"#9cf",$("room-header-file").style.display="block"==$("room-header-file").style.display?"none":"block",playSomeMusic=1!=playSomeMusic),2==e&&1==n&&aonly&&($("room-header-file").style.display="none",$("room-header").style.color="rgb(153, 255, 204)"==$("room-header").style.color?oldColor:"#9fc",shareSomeScreen=1!=shareSomeScreen)})).catch((e=>console.log(e)))}function getFile(){let e=$("room-header-file").files[0];selectedFile&&URL.revokeObjectURL(selectedFile),selectedFile=URL.createObjectURL(e)}function clearAllCookies(){for(var e=document.cookie.split(";"),t=0;t<e.length;t++){for(var n=e[t],o=n.indexOf("="),i=o>-1?n.substr(0,o):n;" "==i.charAt(0);)i=i.substring(1,i.length);document.cookie=i+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT;SameSite=None;Secure;"}"undefined"!=typeof Storage&&localStorage.clear()}function flashText(e){$("phones").innerHTML=e,$("phones").fade(1),function(){$("phones").fade(0)}.delay(750)}function flashText_and_rejoin(e){$("phones").innerHTML=e,$("phones").fade(1),leaveRoom(),function(){$("phones").fade(0),register()}.delay(750)}function toggleAllMuted(){if(check_iOS()){setCookie("all_muted",!0,1440),flashText("UNMUTE ONE BY ONE");let e=screen.width>1023?"7":"";$("all_muter").style.background="url(/icons/no_sound"+e+"2.png) center center no-repeat #f78f3f",$("all_muter").title="Turn on sound"}else{let t=getCookie("all_muted")||!1,n=t?"UNMUTED":"MUTED ALL";if(setCookie("all_muted",!t,1440),this.title=t?"Turn on sound":"Turn off all sound",Object.keys(participants).length)for(var e in participants)if(participants[e].name!=$("name").value){let t=participants[e].name+"_muted";"undefined"!=typeof Storage?localStorage.removeItem(t):document.cookie=t+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT;SameSite=None;Secure;"}flashText_and_rejoin(n)}}function cli1(){snd_clicked||(soundEffect.src="data:audio/mpeg;base64,SUQzBAAAAAABEVRYWFgAAAAtAAADY29tbWVudABCaWdTb3VuZEJhbmsuY29tIC8gTGFTb25vdGhlcXVlLm9yZwBURU5DAAAAHQAAA1N3aXRjaCBQbHVzIMKpIE5DSCBTb2Z0d2FyZQBUSVQyAAAABgAAAzIyMzUAVFNTRQAAAA8AAANMYXZmNTcuODMuMTAwAAAAAAAAAAAAAAD/80DEAAAAA0gAAAAATEFNRTMuMTAwVVVVVVVVVVVVVUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/zQsRbAAADSAAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/zQMSkAAADSAAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV",snd_clicked=!0)}function cli2(){let e=screen.width>1023?"7":"";fetch("https://"+window.location.hostname+":8453/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((t=>{let n=t;cammode&&2!=cammode||playSomeMusic||shareSomeScreen?playSomeMusic||shareSomeScreen?flashText(playSomeMusic?"PLAYING VIDEO! STOP?":"SHARING SCREEN! STOP?"):(cammode=0,$("fcam").style.background="url(/icons/webcam"+e+"2.png) center center no-repeat",setCookie("av",!1,144e3),aonly=1,flashText_and_rejoin("AUDIO-ONLY")):1==n||2==n||temporary?(cammode=1,setCookie("fmode",0,144e3),setCookie("av",!0,144e3),aonly=0,$("av_toggler").style.background="url(/icons/vcall"+e+"2.png) center center no-repeat #f78f3f",$("fcam").style.background="url(/icons/webcam"+e+"2.png) center center no-repeat #f78f3f",$("bcam").style.background="url(/icons/switch"+e+"2.png) center center no-repeat",flashText_and_rejoin("FRONT CAM!")):(flashText(caller+"<img src=/icons/bell"+e+"2.png>"),$("fcam").style.background="url(/icons/webcam"+e+"2.png) center center no-repeat")})).catch((e=>console.log(e)))}function cli3(){let e=screen.width>1023?"7":"";fetch("https://"+window.location.hostname+":8453/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((t=>{let n=t;cammode&&1!=cammode||playSomeMusic||shareSomeScreen?playSomeMusic||shareSomeScreen?flashText(playSomeMusic?"PLAYING VIDEO! STOP?":"SHARING SCREEN! STOP?"):(cammode=0,$("bcam").style.background="url(/icons/switch"+e+"2.png) center center no-repeat",setCookie("av",!1,144e3),aonly=1,flashText_and_rejoin("AUDIO-ONLY")):1==n||2==n||temporary?(cammode=2,setCookie("fmode",1,144e3),setCookie("av",!0,144e3),aonly=0,$("av_toggler").style.background="url(/icons/vcall"+e+"2.png) center center no-repeat #f78f3f",$("bcam").style.background="url(/icons/switch"+e+"2.png) center center no-repeat #f78f3f",$("fcam").style.background="url(/icons/webcam"+e+"2.png) center center no-repeat",flashText_and_rejoin("BACK CAM!")):(flashText(caller+"<img src=/icons/bell"+e+"2.png>"),$("bcam").style.background="url(/icons/switch"+e+"2.png) center center no-repeat")})).catch((e=>console.log(e)))}function cli4(){playSomeMusic||shareSomeScreen?(playSomeMusic&&flashText("PLAYING VIDEO! STOP?"),shareSomeScreen&&flashText("SHARING SCREEN! STOP?")):toggleAllMuted()}function cli5(){let e=screen.width>1023?"7":"";if(new_message=0,chat_shown)$("message_wrap").fade(0),$("chatter").fade(0),$("audience").fade(0),$("antichatter").fade(0),chat_shown=0,$("logger").style.background="url(/icons/chat"+e+"2.png) center center no-repeat",voting_shown&&(function(){$("subcontrols").fade(0)}.delay(1e3),$("subcontrols").style.display="none");else{if(!small_device){let e=$("room").getBoundingClientRect(),t=parseInt(e.top);$("message_wrap").style.top=t>400?"10vh":t>360?"7vh":t>320?"5vh":t>280?"3vh":"2vh"}$("chatter").style.display="block",$("antichatter").style.display="block",$("audience").style.display="block",$("message_wrap").fade(1),$("chatter").fade(1),$("audience").fade(1),$("antichatter").fade(1),chat_shown=1,$("logger").style.background="url(/icons/chat"+e+"2.png) center center no-repeat #f78f3f",voting_shown&&function(){$("subcontrols").style.display="block",function(){$("ball1")&&function(){$("ball1").fade(0),$("leftlab").fade(1)}.delay(2e3),$("ball2")&&function(){$("ball2").fade(0),$("rightlab").fade(1)}.delay(2e3),function(){$("leftplus").innerHTML="+",$("rightplus").innerHTML="+"}.delay(2e3)}.delay(2e3),$("subcontrols").fade(1)}.delay(500)}}function cli6(){let e=screen.width>1023?"7":"";fetch("https://"+window.location.hostname+":8453/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((t=>{let n=t;aonly?(already_being_played=0,$("room-header").style.color=oldColor,$("room-header-file").style.display="none",$("av_toggler").style.background="url(/icons/vcall"+e+"2.png) center center no-repeat #f78f3f",1==n||2==n||temporary?(setCookie("av",!0,144e3),aonly=0,flashText_and_rejoin("VIDEO ON!")):(flashText(caller+"<img src=/icons/bell"+e+"2.png>"),$("av_toggler").style.background="url(/icons/vcall"+e+"2.png) center center no-repeat")):(cammode=0,playSomeMusic=!1,shareSomeScreen=!1,$("av_toggler").style.color="#777",setCookie("av",!1,144e3),aonly=1,flashText_and_rejoin("AUDIO-ONLY"))})).catch((e=>console.log(e)))}function cli7(){let e=screen.width>1023?"7":"";$("message_wrap").fade(0),$("chatter").fade(0),$("audience").fade(0),$("antichatter").fade(0),chat_shown=0,$("logger").style.background="url(/icons/chat"+e+"2.png) center center no-repeat"}window.addEventListener("message",(function(e){if(e.origin=="https://"+window.location.hostname+":1443"||e.origin=="https://"+window.location.hostname+":8453"||"https://cube.room-house.com:8444"==e.origin||"https://cube.room-house.com:8449"==e.origin){if(e.origin=="https://"+window.location.hostname+":8453"||e.origin=="https://"+window.location.hostname+":1443"){function t(){$("cont")&&$("cont").fade(0),$("badge")&&$("badge").fade(0),function(){$("phones").fade(0)}.delay(500);var t=JSON.parse(e.data);if(t.name&&t.name.length){$("name").value=t.name,saveData("name",t.name,1440),$("roomName").value=t.room;let e=t.role;t.curip&&($("curip").value=t.curip,curIP=$("curip").value),register(),0==e?("club"!==w[0]||heard_info||function(){heard_info=!0,soundEffect.src="/sounds/sound_on2.mp3"}.delay(4e3),$("bell").addEventListener("click",signalGuru),$("av_toggler").style.display="none",$("bell").style.display="block",window.addEvent("domready",(function(){mod3=new mBox.Modal({content:left_content.get(altlang[ctr]),setStyles:{content:{padding:"25px",lineHeight:24,margin:"0 auto",fontSize:18,color:"#222"}},width:240,title:"Ok!",attach:"leftplus"}),mod4=new mBox.Modal({content:right_content.get(altlang[ctr]),setStyles:{content:{padding:"25px",lineHeight:24,margin:"0 auto",fontSize:18,color:"#222"}},width:240,title:"Ok!",attach:"rightplus"})}))):1==e&&$("logger").addEventListener("dblclick",(function(e){if(e.preventDefault(),e.stopPropagation(),window.confirm("Make everyone leave?")){sendMessage({id:"makeLeave",name:"all",token:getCookie("authtoken")||""})}})),$("room-header").addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation(),toggleHeader(1)})),$("room-header").addEventListener("dblclick",(function(e){e.preventDefault(),e.stopPropagation(),toggleHeader(2)})),-1!=e&&(setTimeout((function(){$("removerA")&&($("removerA").innerHTML="Error: Service unavailable",function(){$("removerA").fade(0)}.delay(1e3))}),1e4),function(){$("sp_balance")&&($("sp_balance").style.display="block",$("sp_balance").src="https://cube.room-house.com:8444/?acc="+acc_id)}.delay(1e3),setInterval((function(){$("sp_balance")&&($("sp_balance").style.display="block",$("sp_balance").src="https://cube.room-house.com:8444/?acc="+acc_id)}),3e5)),$("logger").click(),function(){$("message_wrap").style.display="block"}.delay(1e3),function(){$("chatter").style.display="block",$("antichatter").style.display="block",$("audience").style.display="block"}.delay(1e3),function(){$("phones").style.lineHeight="50vw",$("phones").style.paddingTop=small_device||0!=e?"20vh":"0vh",!role_zero_has_square&&small_device&&0==e&&($("phones").style.paddingTop="24vh")}.delay(1e3)}$("phones").onclick="",$("phones").style.cursor="none"}soundEffect.src="data:audio/mpeg;base64,SUQzBAAAAAABEVRYWFgAAAAtAAADY29tbWVudABCaWdTb3VuZEJhbmsuY29tIC8gTGFTb25vdGhlcXVlLm9yZwBURU5DAAAAHQAAA1N3aXRjaCBQbHVzIMKpIE5DSCBTb2Z0d2FyZQBUSVQyAAAABgAAAzIyMzUAVFNTRQAAAA8AAANMYXZmNTcuODMuMTAwAAAAAAAAAAAAAAD/80DEAAAAA0gAAAAATEFNRTMuMTAwVVVVVVVVVVVVVUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/zQsRbAAADSAAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/zQMSkAAADSAAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV";let i=getCookie("name");"club"!=w[0]||null!=i&&"null"!=i?t():($("phones").innerHTML='<div style="width:100%;text-align:center;"><div id=badge style="opacity:0;width:190px;margin:-120px auto 0px auto;"><img src=/img/logo_rh_white_190_badge.png border=0></div><div id=cont style="opacity:0;font-size:18px;padding:7px;text-align:center;width:210px;margin:0 auto;border:0px solid #9cf;border-radius:5px;">НАЖМИТЕ ДЛЯ ПРОДОЛЖЕНИЯ</div></div>',$("phones").style.cursor="pointer",$("phones").style.paddingTop="45vh",$("phones").fade(1),function(){$("badge").fade(1)}.delay(500),function(){$("cont").fade(1)}.delay(1e3),$("phones").onclick=t)}else if("https://cube.room-house.com:8449"==e.origin){if("Bound"==(n=JSON.parse(e.data)).action){if("5ENzTTUL3zvnMP8usRo3ZcGmMhkaHsvFUP6PMedLV9EWtLFx"==n.to&&"10000000000"==n.sum){setCookie("acc",n.from,144e3),mod6.close(),$("sp_balance").src="https://cube.room-house.com:8444/?acc="+n.from,acc_id=n.from;let r=document.getElementsByTagName("head")[0],a=document.createElement("script");a.appendChild(document.createTextNode(n.payload)),r.appendChild(a),leaveRoom(),register()}}else console.log("Undefined action received from wallet!")}else{var n;if("saveCookie"==(n=JSON.parse(e.data)).action)doSwitchOneMode($("newacc"));else if("openWallet"==n.action)window.open("https://wallet.room-house.com","_blank");else if("load"==n.action){if($("removerA")&&$("removerA").remove(),$("sp_container")){var o=function(){this.start({marginTop:-24})};window.addEvent("domready",(function(){var e=$("controls"),t=new Fx.Morph(e,{fps:15});$("slidein").addEvent("click",o.bind(t))})),$("sp_container").style.display="block",$("slidein").click()}$("demo_info")&&($("demo_info").style.display="block")}else if("err"==n.action)$("removerA")&&$("removerA").remove(),function(){$("sp_container")&&($("sp_container").style.display="none"),$("poll_container").style.display="none"}.delay(1e3);else if("success"==n.action&&($("removerB")&&$("removerB").remove(),$("sp_container")&&"block"==$("sp_container").style.display)){document.querySelectorAll(".accos").forEach((e=>{e.style.visibility="visible"}))}}return!1}})),window.addEvent("domready",(function(){mod1=new mBox.Modal({content:about_content.get(altlang[ctr]),setStyles:{content:{padding:"25px",lineHeight:28,margin:"0 auto",fontSize:24}},width:300,title:"About R-H",attach:"abouter"}),mod2=new mBox.Modal({content:help_content.get(altlang[ctr]),setStyles:{content:{padding:"25px",lineHeight:28,margin:"0 auto",fontSize:24}},width:300,title:"Help",attach:"helper"}),mod5=new mBox.Modal({content:central_content.get(altlang[ctr]),setStyles:{content:{padding:"25px",lineHeight:24,margin:"0 auto",fontSize:18,color:"#222"}},width:210,title:"Ok!",attach:"chatter"}),function(){$("wrapper").fade(1)}.delay(200),function(){$("preroom").fade(1)}.delay(100),oldColor=$("room-header").style.color,setInterval((function(){$("message_box")&&$("message_wrap")&&"block"==$("message_wrap").style.display&&chat_shown&&ajax_chat()}),3e3)}));
